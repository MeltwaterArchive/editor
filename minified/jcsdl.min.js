;JCSDL={};
(function(b){JCSDL.Loader={compnts:[],loaded:[],isLoaded:!1,addComponent:function(a){"function"==typeof a&&JCSDL.Loader.compnts.push(a)},addLoaded:function(a){"function"==typeof a&&JCSDL.Loader.loaded.push(a)},load:function(){var a=b.jQuery;a.each(JCSDL.Loader.compnts,function(){this.apply(JCSDL,[a])});a.each(JCSDL.Loader.loaded,function(){this.apply(JCSDL,[])});JCSDL.Loader.isLoaded=!0},timeout:function(a){setTimeout(function(){b.jQuery?(a&&b.jQuery.noConflict(),JCSDL.Loader.load()):JCSDL.Loader.timeout()},100)}};
JCSDL.onLoad=function(a){if("function"!==typeof a)return!1;JCSDL.Loader.isLoaded?a.apply(JCSDL,[]):JCSDL.Loader.addLoaded(a)}})(window);;
;("undefined"==typeof Crypto||!Crypto.util)&&function(){var n=window.Crypto={},q=n.util={rotl:function(h,g){return h<<g|h>>>32-g},rotr:function(h,g){return h<<32-g|h>>>g},endian:function(h){if(h.constructor==Number)return q.rotl(h,8)&16711935|q.rotl(h,24)&4278255360;for(var g=0;g<h.length;g++)h[g]=q.endian(h[g]);return h},randomBytes:function(h){for(var g=[];0<h;h--)g.push(Math.floor(256*Math.random()));return g},bytesToWords:function(h){for(var g=[],j=0,a=0;j<h.length;j++,a+=8)g[a>>>5]|=(h[j]&255)<<
24-a%32;return g},wordsToBytes:function(h){for(var g=[],j=0;j<32*h.length;j+=8)g.push(h[j>>>5]>>>24-j%32&255);return g},bytesToHex:function(h){for(var g=[],j=0;j<h.length;j++)g.push((h[j]>>>4).toString(16)),g.push((h[j]&15).toString(16));return g.join("")},hexToBytes:function(h){for(var g=[],j=0;j<h.length;j+=2)g.push(parseInt(h.substr(j,2),16));return g},bytesToBase64:function(h){if("function"==typeof btoa)return btoa(p.bytesToString(h));for(var g=[],j=0;j<h.length;j+=3)for(var a=h[j]<<16|h[j+1]<<
8|h[j+2],b=0;4>b;b++)8*j+6*b<=8*h.length?g.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>>6*(3-b)&63)):g.push("=");return g.join("")},base64ToBytes:function(h){if("function"==typeof atob)return p.stringToBytes(atob(h));h=h.replace(/[^A-Z0-9+\/]/ig,"");for(var g=[],j=0,a=0;j<h.length;a=++j%4)0!=a&&g.push(("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(h.charAt(j-1))&Math.pow(2,-2*a+8)-1)<<2*a|"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(h.charAt(j))>>>
6-2*a);return g}},n=n.charenc={};n.UTF8={stringToBytes:function(h){return p.stringToBytes(unescape(encodeURIComponent(h)))},bytesToString:function(h){return decodeURIComponent(escape(p.bytesToString(h)))}};var p=n.Binary={stringToBytes:function(h){for(var g=[],j=0;j<h.length;j++)g.push(h.charCodeAt(j)&255);return g},bytesToString:function(h){for(var g=[],j=0;j<h.length;j++)g.push(String.fromCharCode(h[j]));return g.join("")}}}();
(function(){var n=Crypto,q=n.util,p=n.charenc,h=p.UTF8,g=p.Binary,j=n.MD5=function(a,b){var h=q.wordsToBytes(j._md5(a));return b&&b.asBytes?h:b&&b.asString?g.bytesToString(h):q.bytesToHex(h)};j._md5=function(a){a.constructor==String&&(a=h.stringToBytes(a));var b=q.bytesToWords(a),g=8*a.length;a=1732584193;for(var d=-271733879,e=-1732584194,c=271733878,f=0;f<b.length;f++)b[f]=(b[f]<<8|b[f]>>>24)&16711935|(b[f]<<24|b[f]>>>8)&4278255360;b[g>>>5]|=128<<g%32;b[(g+64>>>9<<4)+14]=g;for(var g=j._ff,k=j._gg,
l=j._hh,m=j._ii,f=0;f<b.length;f+=16){var n=a,p=d,r=e,s=c;a=g(a,d,e,c,b[f+0],7,-680876936);c=g(c,a,d,e,b[f+1],12,-389564586);e=g(e,c,a,d,b[f+2],17,606105819);d=g(d,e,c,a,b[f+3],22,-1044525330);a=g(a,d,e,c,b[f+4],7,-176418897);c=g(c,a,d,e,b[f+5],12,1200080426);e=g(e,c,a,d,b[f+6],17,-1473231341);d=g(d,e,c,a,b[f+7],22,-45705983);a=g(a,d,e,c,b[f+8],7,1770035416);c=g(c,a,d,e,b[f+9],12,-1958414417);e=g(e,c,a,d,b[f+10],17,-42063);d=g(d,e,c,a,b[f+11],22,-1990404162);a=g(a,d,e,c,b[f+12],7,1804603682);c=g(c,
a,d,e,b[f+13],12,-40341101);e=g(e,c,a,d,b[f+14],17,-1502002290);d=g(d,e,c,a,b[f+15],22,1236535329);a=k(a,d,e,c,b[f+1],5,-165796510);c=k(c,a,d,e,b[f+6],9,-1069501632);e=k(e,c,a,d,b[f+11],14,643717713);d=k(d,e,c,a,b[f+0],20,-373897302);a=k(a,d,e,c,b[f+5],5,-701558691);c=k(c,a,d,e,b[f+10],9,38016083);e=k(e,c,a,d,b[f+15],14,-660478335);d=k(d,e,c,a,b[f+4],20,-405537848);a=k(a,d,e,c,b[f+9],5,568446438);c=k(c,a,d,e,b[f+14],9,-1019803690);e=k(e,c,a,d,b[f+3],14,-187363961);d=k(d,e,c,a,b[f+8],20,1163531501);
a=k(a,d,e,c,b[f+13],5,-1444681467);c=k(c,a,d,e,b[f+2],9,-51403784);e=k(e,c,a,d,b[f+7],14,1735328473);d=k(d,e,c,a,b[f+12],20,-1926607734);a=l(a,d,e,c,b[f+5],4,-378558);c=l(c,a,d,e,b[f+8],11,-2022574463);e=l(e,c,a,d,b[f+11],16,1839030562);d=l(d,e,c,a,b[f+14],23,-35309556);a=l(a,d,e,c,b[f+1],4,-1530992060);c=l(c,a,d,e,b[f+4],11,1272893353);e=l(e,c,a,d,b[f+7],16,-155497632);d=l(d,e,c,a,b[f+10],23,-1094730640);a=l(a,d,e,c,b[f+13],4,681279174);c=l(c,a,d,e,b[f+0],11,-358537222);e=l(e,c,a,d,b[f+3],16,-722521979);
d=l(d,e,c,a,b[f+6],23,76029189);a=l(a,d,e,c,b[f+9],4,-640364487);c=l(c,a,d,e,b[f+12],11,-421815835);e=l(e,c,a,d,b[f+15],16,530742520);d=l(d,e,c,a,b[f+2],23,-995338651);a=m(a,d,e,c,b[f+0],6,-198630844);c=m(c,a,d,e,b[f+7],10,1126891415);e=m(e,c,a,d,b[f+14],15,-1416354905);d=m(d,e,c,a,b[f+5],21,-57434055);a=m(a,d,e,c,b[f+12],6,1700485571);c=m(c,a,d,e,b[f+3],10,-1894986606);e=m(e,c,a,d,b[f+10],15,-1051523);d=m(d,e,c,a,b[f+1],21,-2054922799);a=m(a,d,e,c,b[f+8],6,1873313359);c=m(c,a,d,e,b[f+15],10,-30611744);
e=m(e,c,a,d,b[f+6],15,-1560198380);d=m(d,e,c,a,b[f+13],21,1309151649);a=m(a,d,e,c,b[f+4],6,-145523070);c=m(c,a,d,e,b[f+11],10,-1120210379);e=m(e,c,a,d,b[f+2],15,718787259);d=m(d,e,c,a,b[f+9],21,-343485551);a=a+n>>>0;d=d+p>>>0;e=e+r>>>0;c=c+s>>>0}return q.endian([a,d,e,c])};j._ff=function(a,b,g,d,e,c,f){a=a+(b&g|~b&d)+(e>>>0)+f;return(a<<c|a>>>32-c)+b};j._gg=function(a,b,g,d,e,c,f){a=a+(b&d|g&~d)+(e>>>0)+f;return(a<<c|a>>>32-c)+b};j._hh=function(a,b,g,d,e,c,f){a=a+(b^g^d)+(e>>>0)+f;return(a<<c|a>>>
32-c)+b};j._ii=function(a,b,g,d,e,c,f){a=a+(g^(b|~d))+(e>>>0)+f;return(a<<c|a>>>32-c)+b};j._blocksize=16;j._digestsize=16})();;
;JCSDL.Loader.addComponent(function(){var h=jQuery,x=function(a,b){var c,d,e,k=a.nodeName.toLowerCase();return"area"===k?(c=a.parentNode,d=c.name,!a.href||!d||"map"!==c.nodeName.toLowerCase()?!1:(e=h("img[usemap=#"+d+"]")[0],!!e&&w(e))):(/input|select|textarea|button|object/.test(k)?!a.disabled:"a"===k?a.href||b:b)&&w(a)},w=function(a){return h.expr.filters.visible(a)&&!h(a).parents().andSelf().filter(function(){return"hidden"===h.css(this,"visibility")}).length},B=0,C=/^ui-id-\d+$/;h.ui=h.ui||{};
if(!h.ui.version){h.extend(h.ui,{version:"1.9.2",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}});h.fn.extend({_focus:h.fn.focus,focus:function(a,b){return"number"==typeof a?this.each(function(){var c=this;setTimeout(function(){h(c).focus();b&&b.call(c)},a)}):this._focus.apply(this,
arguments)},scrollParent:function(){var a;return h.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?a=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(h.css(this,"position"))&&/(auto|scroll)/.test(h.css(this,"overflow")+h.css(this,"overflow-y")+h.css(this,"overflow-x"))}).eq(0):a=this.parents().filter(function(){return/(auto|scroll)/.test(h.css(this,"overflow")+h.css(this,"overflow-y")+h.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||
!a.length?h(document):a},zIndex:function(a){if(void 0!==a)return this.css("zIndex",a);if(this.length){a=h(this[0]);for(var b;a.length&&a[0]!==document;){b=a.css("position");if("absolute"===b||"relative"===b||"fixed"===b)if(b=parseInt(a.css("zIndex"),10),!isNaN(b)&&0!==b)return b;a=a.parent()}}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++B)})},removeUniqueId:function(){return this.each(function(){C.test(this.id)&&h(this).removeAttr("id")})}});h.extend(h.expr[":"],
{data:h.expr.createPseudo?h.expr.createPseudo(function(a){return function(b){return!!h.data(b,a)}}):function(a,b,c){return!!h.data(a,c[3])},focusable:function(a){return x(a,!isNaN(h.attr(a,"tabindex")))},tabbable:function(a){var b=h.attr(a,"tabindex"),c=isNaN(b);return(c||0<=b)&&x(a,!c)}});h(function(){var a=document.body,b=a.appendChild(b=document.createElement("div"));b.offsetHeight;h.extend(b.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});h.support.minHeight=100===b.offsetHeight;
h.support.selectstart="onselectstart"in b;a.removeChild(b).style.display="none"});h("<a>").outerWidth(1).jquery||h.each(["Width","Height"],function(a,b){function c(a,b,c,e){return h.each(d,function(){b-=parseFloat(h.css(a,"padding"+this))||0;c&&(b-=parseFloat(h.css(a,"border"+this+"Width"))||0);e&&(b-=parseFloat(h.css(a,"margin"+this))||0)}),b}var d="Width"===b?["Left","Right"]:["Top","Bottom"],e=b.toLowerCase(),k={innerWidth:h.fn.innerWidth,innerHeight:h.fn.innerHeight,outerWidth:h.fn.outerWidth,
outerHeight:h.fn.outerHeight};h.fn["inner"+b]=function(a){return void 0===a?k["inner"+b].call(this):this.each(function(){h(this).css(e,c(this,a)+"px")})};h.fn["outer"+b]=function(a,d){return"number"!=typeof a?k["outer"+b].call(this,a):this.each(function(){h(this).css(e,c(this,a,!0,d)+"px")})}});if(h("<a>").data("a-b","a").removeData("a-b").data("a-b")){var y=h.fn.removeData;h.fn.removeData=function(a){return arguments.length?y.call(this,h.camelCase(a)):y.call(this)}}var z=/msie ([\w.]+)/.exec(navigator.userAgent.toLowerCase())||
[];h.ui.ie=z.length?!0:!1;h.ui.ie6=6===parseFloat(z[1],10);h.fn.extend({disableSelection:function(){return this.bind((h.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}});h.extend(h.ui,{plugin:{add:function(a,b,c){var d;a=h.ui[a].prototype;for(d in c)a.plugins[d]=a.plugins[d]||[],a.plugins[d].push([b,c[d]])},call:function(a,b,c){var d=a.plugins[b];if(d&&a.element[0].parentNode&&
11!==a.element[0].parentNode.nodeType)for(b=0;b<d.length;b++)a.options[d[b][0]]&&d[b][1].apply(a.element,c)}},contains:h.contains,hasScroll:function(a,b){if("hidden"===h(a).css("overflow"))return!1;var c=b&&"left"===b?"scrollLeft":"scrollTop";return 0<a[c]?!0:(a[c]=1,a[c]=0,!1)},isOverAxis:function(a,b,c){return a>b&&a<b+c},isOver:function(a,b,c,d,e,k){return h.ui.isOverAxis(a,c,e)&&h.ui.isOverAxis(b,d,k)}})}var j=jQuery,D=0,A=Array.prototype.slice,E=j.cleanData;j.cleanData=function(a){for(var b=
0,c;null!=(c=a[b]);b++)try{j(c).triggerHandler("remove")}catch(d){}E(a)};j.widget=function(a,b,c){var d,e,k,f,g=a.split(".")[0];a=a.split(".")[1];d=g+"-"+a;c||(c=b,b=j.Widget);j.expr[":"][d.toLowerCase()]=function(a){return!!j.data(a,d)};j[g]=j[g]||{};e=j[g][a];k=j[g][a]=function(a,b){if(!this._createWidget)return new k(a,b);arguments.length&&this._createWidget(a,b)};j.extend(k,e,{version:c.version,_proto:j.extend({},c),_childConstructors:[]});f=new b;f.options=j.widget.extend({},f.options);j.each(c,
function(a,d){if(j.isFunction(d)){var e=function(){return b.prototype[a].apply(this,arguments)},k=function(c){return b.prototype[a].apply(this,c)};c[a]=function(){var a=this._super,b=this._superApply,c;return this._super=e,this._superApply=k,c=d.apply(this,arguments),this._super=a,this._superApply=b,c}}});k.prototype=j.widget.extend(f,{widgetEventPrefix:e?f.widgetEventPrefix:a},c,{constructor:k,namespace:g,widgetName:a,widgetBaseClass:d,widgetFullName:d});e?(j.each(e._childConstructors,function(a,
b){var c=b.prototype;j.widget(c.namespace+"."+c.widgetName,k,b._proto)}),delete e._childConstructors):b._childConstructors.push(k);j.widget.bridge(a,k)};j.widget.extend=function(a){for(var b=A.call(arguments,1),c=0,d=b.length,e,k;c<d;c++)for(e in b[c])k=b[c][e],b[c].hasOwnProperty(e)&&void 0!==k&&(j.isPlainObject(k)?a[e]=j.isPlainObject(a[e])?j.widget.extend({},a[e],k):j.widget.extend({},k):a[e]=k);return a};j.widget.bridge=function(a,b){var c=b.prototype.widgetFullName||a;j.fn[a]=function(d){var e=
"string"==typeof d,k=A.call(arguments,1),f=this;return d=!e&&k.length?j.widget.extend.apply(null,[d].concat(k)):d,e?this.each(function(){var b,e=j.data(this,c);if(!e)return j.error("cannot call methods on "+a+" prior to initialization; attempted to call method '"+d+"'");if(!j.isFunction(e[d])||"_"===d.charAt(0))return j.error("no such method '"+d+"' for "+a+" widget instance");b=e[d].apply(e,k);if(b!==e&&void 0!==b)return f=b&&b.jquery?f.pushStack(b.get()):b,!1}):this.each(function(){var a=j.data(this,
c);a?a.option(d||{})._init():j.data(this,c,new b(d,this))}),f}};j.Widget=function(){};j.Widget._childConstructors=[];j.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(a,b){b=j(b||this.defaultElement||this)[0];this.element=j(b);this.uuid=D++;this.eventNamespace="."+this.widgetName+this.uuid;this.options=j.widget.extend({},this.options,this._getCreateOptions(),a);this.bindings=j();this.hoverable=j();this.focusable=
j();b!==this&&(j.data(b,this.widgetName,this),j.data(b,this.widgetFullName,this),this._on(!0,this.element,{remove:function(a){a.target===b&&this.destroy()}}),this.document=j(b.style?b.ownerDocument:b.document||b),this.window=j(this.document[0].defaultView||this.document[0].parentWindow));this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:j.noop,_getCreateEventData:j.noop,_create:j.noop,_init:j.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(j.camelCase(this.widgetFullName));
this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:j.noop,widget:function(){return this.element},option:function(a,b){var c=a,d,e,k;if(0===arguments.length)return j.widget.extend({},this.options);if("string"==typeof a)if(c={},d=a.split("."),a=d.shift(),d.length){e=c[a]=j.widget.extend({},
this.options[a]);for(k=0;k<d.length-1;k++)e[d[k]]=e[d[k]]||{},e=e[d[k]];a=d.pop();if(void 0===b)return void 0===e[a]?null:e[a];e[a]=b}else{if(void 0===b)return void 0===this.options[a]?null:this.options[a];c[a]=b}return this._setOptions(c),this},_setOptions:function(a){for(var b in a)this._setOption(b,a[b]);return this},_setOption:function(a,b){return this.options[a]=b,"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!b).attr("aria-disabled",b),this.hoverable.removeClass("ui-state-hover"),
this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(a,b,c){var d,e=this;"boolean"!=typeof a&&(c=b,b=a,a=!1);c?(b=d=j(b),this.bindings=this.bindings.add(b)):(c=b,b=this.element,d=this.widget());j.each(c,function(c,f){function g(){if(a||!(!0===e.options.disabled||j(this).hasClass("ui-state-disabled")))return("string"==typeof f?e[f]:f).apply(e,arguments)}"string"!=typeof f&&
(g.guid=f.guid=f.guid||g.guid||j.guid++);var h=c.match(/^(\w+)\s*(.*)$/),l=h[1]+e.eventNamespace;(h=h[2])?d.delegate(h,l,g):b.bind(l,g)})},_off:function(a,b){b=(b||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;a.unbind(b).undelegate(b)},_delay:function(a,b){var c=this;return setTimeout(function(){return("string"==typeof a?c[a]:a).apply(c,arguments)},b||0)},_hoverable:function(a){this.hoverable=this.hoverable.add(a);this._on(a,{mouseenter:function(a){j(a.currentTarget).addClass("ui-state-hover")},
mouseleave:function(a){j(a.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(a){this.focusable=this.focusable.add(a);this._on(a,{focusin:function(a){j(a.currentTarget).addClass("ui-state-focus")},focusout:function(a){j(a.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(a,b,c){var d,e=this.options[a];c=c||{};b=j.Event(b);b.type=(a===this.widgetEventPrefix?a:this.widgetEventPrefix+a).toLowerCase();b.target=this.element[0];if(a=b.originalEvent)for(d in a)d in b||
(b[d]=a[d]);return this.element.trigger(b,c),!(j.isFunction(e)&&!1===e.apply(this.element[0],[b].concat(c))||b.isDefaultPrevented())}};j.each({show:"fadeIn",hide:"fadeOut"},function(a,b){j.Widget.prototype["_"+a]=function(c,d,e){"string"==typeof d&&(d={effect:d});var k,f=d?!0===d||"number"==typeof d?b:d.effect||b:a;d=d||{};"number"==typeof d&&(d={duration:d});k=!j.isEmptyObject(d);d.complete=e;d.delay&&c.delay(d.delay);k&&j.effects&&(j.effects.effect[f]||!1!==j.uiBackCompat&&j.effects[f])?c[a](d):
f!==a&&c[f]?c[f](d.duration,d.easing,e):c.queue(function(b){j(this)[a]();e&&e.call(c[0]);b()})}});!1!==j.uiBackCompat&&(j.Widget.prototype._getCreateOptions=function(){return j.metadata&&j.metadata.get(this.element[0])[this.widgetName]});var m=jQuery,s=!1;m(document).mouseup(function(){s=!1});m.widget("ui.mouse",{version:"1.9.2",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var a=this;this.element.bind("mousedown."+this.widgetName,function(b){return a._mouseDown(b)}).bind("click."+
this.widgetName,function(b){if(!0===m.data(b.target,a.widgetName+".preventClickEvent"))return m.removeData(b.target,a.widgetName+".preventClickEvent"),b.stopImmediatePropagation(),!1});this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);this._mouseMoveDelegate&&m(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(a){if(!s){this._mouseStarted&&this._mouseUp(a);this._mouseDownEvent=
a;var b=this,c=1===a.which,d="string"==typeof this.options.cancel&&a.target.nodeName?m(a.target).closest(this.options.cancel).length:!1;if(!c||d||!this._mouseCapture(a))return!0;(this.mouseDelayMet=!this.options.delay)||(this._mouseDelayTimer=setTimeout(function(){b.mouseDelayMet=!0},this.options.delay));return this._mouseDistanceMet(a)&&this._mouseDelayMet(a)&&(this._mouseStarted=!1!==this._mouseStart(a),!this._mouseStarted)?(a.preventDefault(),!0):(!0===m.data(a.target,this.widgetName+".preventClickEvent")&&
m.removeData(a.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return b._mouseMove(a)},this._mouseUpDelegate=function(a){return b._mouseUp(a)},m(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),a.preventDefault(),s=!0,!0)}},_mouseMove:function(a){return!m.ui.ie||9<=document.documentMode||a.button?this._mouseStarted?(this._mouseDrag(a),a.preventDefault()):(this._mouseDistanceMet(a)&&this._mouseDelayMet(a)&&
(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,a),this._mouseStarted?this._mouseDrag(a):this._mouseUp(a)),!this._mouseStarted):this._mouseUp(a)},_mouseUp:function(a){return m(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,a.target===this._mouseDownEvent.target&&m.data(a.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(a)),!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-
a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}});var f=jQuery;f.widget("ui.draggable",f.ui.mouse,{version:"1.9.2",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,
refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){"original"==this.options.helper&&!/^(?:r|a|f)/.test(this.element.css("position"))&&(this.element[0].style.position="relative");this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");
this._mouseDestroy()},_mouseCapture:function(a){var b=this.options;return this.helper||b.disabled||f(a.target).is(".ui-resizable-handle")?!1:(this.handle=this._getHandle(a),this.handle?(f(!0===b.iframeFix?"iframe":b.iframeFix).each(function(){f('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1E3}).css(f(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(a){var b=
this.options;return this.helper=this._createHelper(a),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),f.ui.ddmanager&&(f.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},f.extend(this.offset,{click:{left:a.pageX-this.offset.left,top:a.pageY-
this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(a),this.originalPageX=a.pageX,this.originalPageY=a.pageY,b.cursorAt&&this._adjustOffsetFromHelper(b.cursorAt),b.containment&&this._setContainment(),!1===this._trigger("start",a)?(this._clear(),!1):(this._cacheHelperProportions(),f.ui.ddmanager&&!b.dropBehaviour&&f.ui.ddmanager.prepareOffsets(this,a),this._mouseDrag(a,!0),f.ui.ddmanager&&f.ui.ddmanager.dragStart(this,
a),!0)},_mouseDrag:function(a,b){this.position=this._generatePosition(a);this.positionAbs=this._convertPositionTo("absolute");if(!b){var c=this._uiHash();if(!1===this._trigger("drag",a,c))return this._mouseUp({}),!1;this.position=c.position}if(!this.options.axis||"y"!=this.options.axis)this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||"x"!=this.options.axis)this.helper[0].style.top=this.position.top+"px";return f.ui.ddmanager&&f.ui.ddmanager.drag(this,a),!1},_mouseStop:function(a){var b=
!1;f.ui.ddmanager&&!this.options.dropBehaviour&&(b=f.ui.ddmanager.drop(this,a));this.dropped&&(b=this.dropped,this.dropped=!1);for(var c=this.element[0],d=!1;c&&(c=c.parentNode);)c==document&&(d=!0);if(!d&&"original"===this.options.helper)return!1;if("invalid"==this.options.revert&&!b||"valid"==this.options.revert&&b||!0===this.options.revert||f.isFunction(this.options.revert)&&this.options.revert.call(this.element,b)){var e=this;f(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,
10),function(){!1!==e._trigger("stop",a)&&e._clear()})}else!1!==this._trigger("stop",a)&&this._clear();return!1},_mouseUp:function(a){return f("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),f.ui.ddmanager&&f.ui.ddmanager.dragStop(this,a),f.ui.mouse.prototype._mouseUp.call(this,a)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(a){var b=!this.options.handle||!f(this.options.handle,this.element).length?
!0:!1;return f(this.options.handle,this.element).find("*").andSelf().each(function(){this==a.target&&(b=!0)}),b},_createHelper:function(a){var b=this.options;a=f.isFunction(b.helper)?f(b.helper.apply(this.element[0],[a])):"clone"==b.helper?this.element.clone().removeAttr("id"):this.element;return a.parents("body").length||a.appendTo("parent"==b.appendTo?this.element[0].parentNode:b.appendTo),a[0]!=this.element[0]&&!/(fixed|absolute)/.test(a.css("position"))&&a.css("position","absolute"),a},_adjustOffsetFromHelper:function(a){"string"==
typeof a&&(a=a.split(" "));f.isArray(a)&&(a={left:+a[0],top:+a[1]||0});"left"in a&&(this.offset.click.left=a.left+this.margins.left);"right"in a&&(this.offset.click.left=this.helperProportions.width-a.right+this.margins.left);"top"in a&&(this.offset.click.top=a.top+this.margins.top);"bottom"in a&&(this.offset.click.top=this.helperProportions.height-a.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var a=this.offsetParent.offset();"absolute"==this.cssPosition&&
this.scrollParent[0]!=document&&f.contains(this.scrollParent[0],this.offsetParent[0])&&(a.left+=this.scrollParent.scrollLeft(),a.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&f.ui.ie)a={top:0,left:0};return{top:a.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:a.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==
this.cssPosition){var a=this.element.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions=
{width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var a=this.options;"parent"==a.containment&&(a.containment=this.helper[0].parentNode);if("document"==a.containment||"window"==a.containment)this.containment=["document"==a.containment?0:f(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,"document"==a.containment?0:f(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,("document"==a.containment?0:f(window).scrollLeft())+
f("document"==a.containment?document:window).width()-this.helperProportions.width-this.margins.left,("document"==a.containment?0:f(window).scrollTop())+(f("document"==a.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(a.containment)&&a.containment.constructor!=Array){var a=f(a.containment),b=a[0];if(b){a.offset();var c="hidden"!=f(b).css("overflow");this.containment=[(parseInt(f(b).css("borderLeftWidth"),
10)||0)+(parseInt(f(b).css("paddingLeft"),10)||0),(parseInt(f(b).css("borderTopWidth"),10)||0)+(parseInt(f(b).css("paddingTop"),10)||0),(c?Math.max(b.scrollWidth,b.offsetWidth):b.offsetWidth)-(parseInt(f(b).css("borderLeftWidth"),10)||0)-(parseInt(f(b).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(c?Math.max(b.scrollHeight,b.offsetHeight):b.offsetHeight)-(parseInt(f(b).css("borderTopWidth"),10)||0)-(parseInt(f(b).css("paddingBottom"),10)||0)-this.helperProportions.height-
this.margins.top-this.margins.bottom];this.relative_container=a}}else a.containment.constructor==Array&&(this.containment=a.containment)},_convertPositionTo:function(a,b){b||(b=this.position);var c="absolute"==a?1:-1,d="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&f.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,e=/(html|body)/i.test(d[0].tagName);return{top:b.top+this.offset.relative.top*c+this.offset.parent.top*c-("fixed"==this.cssPosition?
-this.scrollParent.scrollTop():e?0:d.scrollTop())*c,left:b.left+this.offset.relative.left*c+this.offset.parent.left*c-("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():e?0:d.scrollLeft())*c}},_generatePosition:function(a){var b=this.options,c="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&f.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,d=/(html|body)/i.test(c[0].tagName),e=a.pageX,k=a.pageY;if(this.originalPosition){var g;this.containment&&
(this.relative_container?(g=this.relative_container.offset(),g=[this.containment[0]+g.left,this.containment[1]+g.top,this.containment[2]+g.left,this.containment[3]+g.top]):g=this.containment,a.pageX-this.offset.click.left<g[0]&&(e=g[0]+this.offset.click.left),a.pageY-this.offset.click.top<g[1]&&(k=g[1]+this.offset.click.top),a.pageX-this.offset.click.left>g[2]&&(e=g[2]+this.offset.click.left),a.pageY-this.offset.click.top>g[3]&&(k=g[3]+this.offset.click.top));b.grid&&(k=b.grid[1]?this.originalPageY+
Math.round((k-this.originalPageY)/b.grid[1])*b.grid[1]:this.originalPageY,k=g?k-this.offset.click.top<g[1]||k-this.offset.click.top>g[3]?k-this.offset.click.top<g[1]?k+b.grid[1]:k-b.grid[1]:k:k,e=b.grid[0]?this.originalPageX+Math.round((e-this.originalPageX)/b.grid[0])*b.grid[0]:this.originalPageX,e=g?e-this.offset.click.left<g[0]||e-this.offset.click.left>g[2]?e-this.offset.click.left<g[0]?e+b.grid[0]:e-b.grid[0]:e:e)}return{top:k-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+
("fixed"==this.cssPosition?-this.scrollParent.scrollTop():d?0:c.scrollTop()),left:e-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():d?0:c.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove();this.helper=null;this.cancelHelperRemoval=!1},_trigger:function(a,b,c){return c=c||this._uiHash(),f.ui.plugin.call(this,
a,[b,c]),"drag"==a&&(this.positionAbs=this._convertPositionTo("absolute")),f.Widget.prototype._trigger.call(this,a,b,c)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});f.ui.plugin.add("draggable","connectToSortable",{start:function(a,b){var c=f(this).data("draggable"),d=c.options,e=f.extend({},b,{item:c.element});c.sortables=[];f(d.connectToSortable).each(function(){var b=f.data(this,"sortable");b&&
!b.options.disabled&&(c.sortables.push({instance:b,shouldRevert:b.options.revert}),b.refreshPositions(),b._trigger("activate",a,e))})},stop:function(a,b){var c=f(this).data("draggable"),d=f.extend({},b,{item:c.element});f.each(c.sortables,function(){this.instance.isOver?(this.instance.isOver=0,c.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(a),this.instance.options.helper=this.instance.options._helper,"original"==
c.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",a,d))})},drag:function(a,b){var c=f(this).data("draggable"),d=this;f.each(c.sortables,function(){var e=!1,k=this;this.instance.positionAbs=c.positionAbs;this.instance.helperProportions=c.helperProportions;this.instance.offset.click=c.offset.click;this.instance._intersectsWith(this.instance.containerCache)&&(e=!0,f.each(c.sortables,function(){return this.instance.positionAbs=
c.positionAbs,this.instance.helperProportions=c.helperProportions,this.instance.offset.click=c.offset.click,this!=k&&this.instance._intersectsWith(this.instance.containerCache)&&f.ui.contains(k.instance.element[0],this.instance.element[0])&&(e=!1),e}));e?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=f(d).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=
function(){return b.helper[0]},a.target=this.instance.currentItem[0],this.instance._mouseCapture(a,!0),this.instance._mouseStart(a,!0,!0),this.instance.offset.click.top=c.offset.click.top,this.instance.offset.click.left=c.offset.click.left,this.instance.offset.parent.left-=c.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=c.offset.parent.top-this.instance.offset.parent.top,c._trigger("toSortable",a),c.dropped=this.instance.element,c.currentItem=c.element,this.instance.fromOutside=
c),this.instance.currentItem&&this.instance._mouseDrag(a)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",a,this.instance._uiHash(this.instance)),this.instance._mouseStop(a,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),c._trigger("fromSortable",a),c.dropped=!1)})}});f.ui.plugin.add("draggable",
"cursor",{start:function(){var a=f("body"),b=f(this).data("draggable").options;a.css("cursor")&&(b._cursor=a.css("cursor"));a.css("cursor",b.cursor)},stop:function(){var a=f(this).data("draggable").options;a._cursor&&f("body").css("cursor",a._cursor)}});f.ui.plugin.add("draggable","opacity",{start:function(a,b){var c=f(b.helper),d=f(this).data("draggable").options;c.css("opacity")&&(d._opacity=c.css("opacity"));c.css("opacity",d.opacity)},stop:function(a,b){var c=f(this).data("draggable").options;
c._opacity&&f(b.helper).css("opacity",c._opacity)}});f.ui.plugin.add("draggable","scroll",{start:function(){var a=f(this).data("draggable");a.scrollParent[0]!=document&&"HTML"!=a.scrollParent[0].tagName&&(a.overflowOffset=a.scrollParent.offset())},drag:function(a){var b=f(this).data("draggable"),c=b.options,d=!1;if(b.scrollParent[0]!=document&&"HTML"!=b.scrollParent[0].tagName){if(!c.axis||"x"!=c.axis)b.overflowOffset.top+b.scrollParent[0].offsetHeight-a.pageY<c.scrollSensitivity?b.scrollParent[0].scrollTop=
d=b.scrollParent[0].scrollTop+c.scrollSpeed:a.pageY-b.overflowOffset.top<c.scrollSensitivity&&(b.scrollParent[0].scrollTop=d=b.scrollParent[0].scrollTop-c.scrollSpeed);if(!c.axis||"y"!=c.axis)b.overflowOffset.left+b.scrollParent[0].offsetWidth-a.pageX<c.scrollSensitivity?b.scrollParent[0].scrollLeft=d=b.scrollParent[0].scrollLeft+c.scrollSpeed:a.pageX-b.overflowOffset.left<c.scrollSensitivity&&(b.scrollParent[0].scrollLeft=d=b.scrollParent[0].scrollLeft-c.scrollSpeed)}else{if(!c.axis||"x"!=c.axis)a.pageY-
f(document).scrollTop()<c.scrollSensitivity?d=f(document).scrollTop(f(document).scrollTop()-c.scrollSpeed):f(window).height()-(a.pageY-f(document).scrollTop())<c.scrollSensitivity&&(d=f(document).scrollTop(f(document).scrollTop()+c.scrollSpeed));if(!c.axis||"y"!=c.axis)a.pageX-f(document).scrollLeft()<c.scrollSensitivity?d=f(document).scrollLeft(f(document).scrollLeft()-c.scrollSpeed):f(window).width()-(a.pageX-f(document).scrollLeft())<c.scrollSensitivity&&(d=f(document).scrollLeft(f(document).scrollLeft()+
c.scrollSpeed))}!1!==d&&f.ui.ddmanager&&!c.dropBehaviour&&f.ui.ddmanager.prepareOffsets(b,a)}});f.ui.plugin.add("draggable","snap",{start:function(){var a=f(this).data("draggable"),b=a.options;a.snapElements=[];f(b.snap.constructor!=String?b.snap.items||":data(draggable)":b.snap).each(function(){var b=f(this),d=b.offset();this!=a.element[0]&&a.snapElements.push({item:this,width:b.outerWidth(),height:b.outerHeight(),top:d.top,left:d.left})})},drag:function(a,b){for(var c=f(this).data("draggable"),
d=c.options,e=d.snapTolerance,k=b.offset.left,g=k+c.helperProportions.width,j=b.offset.top,h=j+c.helperProportions.height,l=c.snapElements.length-1;0<=l;l--){var n=c.snapElements[l].left,m=n+c.snapElements[l].width,p=c.snapElements[l].top,q=p+c.snapElements[l].height;if(n-e<k&&k<m+e&&p-e<j&&j<q+e||n-e<k&&k<m+e&&p-e<h&&h<q+e||n-e<g&&g<m+e&&p-e<j&&j<q+e||n-e<g&&g<m+e&&p-e<h&&h<q+e){if("inner"!=d.snapMode){var r=Math.abs(p-h)<=e,t=Math.abs(q-j)<=e,u=Math.abs(n-g)<=e,v=Math.abs(m-k)<=e;r&&(b.position.top=
c._convertPositionTo("relative",{top:p-c.helperProportions.height,left:0}).top-c.margins.top);t&&(b.position.top=c._convertPositionTo("relative",{top:q,left:0}).top-c.margins.top);u&&(b.position.left=c._convertPositionTo("relative",{top:0,left:n-c.helperProportions.width}).left-c.margins.left);v&&(b.position.left=c._convertPositionTo("relative",{top:0,left:m}).left-c.margins.left)}var s=r||t||u||v;"outer"!=d.snapMode&&(r=Math.abs(p-j)<=e,t=Math.abs(q-h)<=e,u=Math.abs(n-k)<=e,v=Math.abs(m-g)<=e,r&&
(b.position.top=c._convertPositionTo("relative",{top:p,left:0}).top-c.margins.top),t&&(b.position.top=c._convertPositionTo("relative",{top:q-c.helperProportions.height,left:0}).top-c.margins.top),u&&(b.position.left=c._convertPositionTo("relative",{top:0,left:n}).left-c.margins.left),v&&(b.position.left=c._convertPositionTo("relative",{top:0,left:m-c.helperProportions.width}).left-c.margins.left));!c.snapElements[l].snapping&&(r||t||u||v||s)&&c.options.snap.snap&&c.options.snap.snap.call(c.element,
a,f.extend(c._uiHash(),{snapItem:c.snapElements[l].item}));c.snapElements[l].snapping=r||t||u||v||s}else c.snapElements[l].snapping&&c.options.snap.release&&c.options.snap.release.call(c.element,a,f.extend(c._uiHash(),{snapItem:c.snapElements[l].item})),c.snapElements[l].snapping=!1}}});f.ui.plugin.add("draggable","stack",{start:function(){var a=f(this).data("draggable").options,a=f.makeArray(f(a.stack)).sort(function(a,b){return(parseInt(f(a).css("zIndex"),10)||0)-(parseInt(f(b).css("zIndex"),10)||
0)});if(a.length){var b=parseInt(a[0].style.zIndex)||0;f(a).each(function(a){this.style.zIndex=b+a});this[0].style.zIndex=b+a.length}}});f.ui.plugin.add("draggable","zIndex",{start:function(a,b){var c=f(b.helper),d=f(this).data("draggable").options;c.css("zIndex")&&(d._zIndex=c.css("zIndex"));c.css("zIndex",d.zIndex)},stop:function(a,b){var c=f(this).data("draggable").options;c._zIndex&&f(b.helper).css("zIndex",c._zIndex)}});var g=jQuery;g.widget("ui.sortable",g.ui.mouse,{version:"1.9.2",widgetEventPrefix:"sort",
ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1E3},_create:function(){var a=this.options;this.containerCache={};this.element.addClass("ui-sortable");this.refresh();this.floating=this.items.length?"x"===a.axis||/left|right/.test(this.items[0].item.css("float"))||
/inline|table-cell/.test(this.items[0].item.css("display")):!1;this.offset=this.element.offset();this._mouseInit();this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled");this._mouseDestroy();for(var a=this.items.length-1;0<=a;a--)this.items[a].item.removeData(this.widgetName+"-item");return this},_setOption:function(a,b){"disabled"===a?(this.options[a]=b,this.widget().toggleClass("ui-sortable-disabled",!!b)):g.Widget.prototype._setOption.apply(this,arguments)},
_mouseCapture:function(a,b){var c=this;if(this.reverting||this.options.disabled||"static"==this.options.type)return!1;this._refreshItems(a);var d=null;g(a.target).parents().each(function(){if(g.data(this,c.widgetName+"-item")==c)return d=g(this),!1});g.data(a.target,c.widgetName+"-item")==c&&(d=g(a.target));if(!d)return!1;if(this.options.handle&&!b){var e=!1;g(this.options.handle,d).find("*").andSelf().each(function(){this==a.target&&(e=!0)});if(!e)return!1}return this.currentItem=d,this._removeCurrentsFromItems(),
!0},_mouseStart:function(a,b,c){b=this.options;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(a);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};g.extend(this.offset,{click:{left:a.pageX-this.offset.left,top:a.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});
this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");this.originalPosition=this._generatePosition(a);this.originalPageX=a.pageX;this.originalPageY=a.pageY;b.cursorAt&&this._adjustOffsetFromHelper(b.cursorAt);this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};this.helper[0]!=this.currentItem[0]&&this.currentItem.hide();this._createPlaceholder();b.containment&&this._setContainment();b.cursor&&(g("body").css("cursor")&&(this._storedCursor=
g("body").css("cursor")),g("body").css("cursor",b.cursor));b.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",b.opacity));b.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",b.zIndex));this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset());this._trigger("start",a,this._uiHash());this._preserveHelperProportions||this._cacheHelperProportions();
if(!c)for(c=this.containers.length-1;0<=c;c--)this.containers[c]._trigger("activate",a,this._uiHash(this));return g.ui.ddmanager&&(g.ui.ddmanager.current=this),g.ui.ddmanager&&!b.dropBehaviour&&g.ui.ddmanager.prepareOffsets(this,a),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(a),!0},_mouseDrag:function(a){this.position=this._generatePosition(a);this.positionAbs=this._convertPositionTo("absolute");this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs);if(this.options.scroll){var b=
this.options,c=!1;this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-a.pageY<b.scrollSensitivity?this.scrollParent[0].scrollTop=c=this.scrollParent[0].scrollTop+b.scrollSpeed:a.pageY-this.overflowOffset.top<b.scrollSensitivity&&(this.scrollParent[0].scrollTop=c=this.scrollParent[0].scrollTop-b.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-a.pageX<b.scrollSensitivity?this.scrollParent[0].scrollLeft=
c=this.scrollParent[0].scrollLeft+b.scrollSpeed:a.pageX-this.overflowOffset.left<b.scrollSensitivity&&(this.scrollParent[0].scrollLeft=c=this.scrollParent[0].scrollLeft-b.scrollSpeed)):(a.pageY-g(document).scrollTop()<b.scrollSensitivity?c=g(document).scrollTop(g(document).scrollTop()-b.scrollSpeed):g(window).height()-(a.pageY-g(document).scrollTop())<b.scrollSensitivity&&(c=g(document).scrollTop(g(document).scrollTop()+b.scrollSpeed)),a.pageX-g(document).scrollLeft()<b.scrollSensitivity?c=g(document).scrollLeft(g(document).scrollLeft()-
b.scrollSpeed):g(window).width()-(a.pageX-g(document).scrollLeft())<b.scrollSensitivity&&(c=g(document).scrollLeft(g(document).scrollLeft()+b.scrollSpeed)));!1!==c&&g.ui.ddmanager&&!b.dropBehaviour&&g.ui.ddmanager.prepareOffsets(this,a)}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||"y"!=this.options.axis)this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||"x"!=this.options.axis)this.helper[0].style.top=this.position.top+"px";for(b=this.items.length-
1;0<=b;b--){var c=this.items[b],d=c.item[0],e=this._intersectsWithPointer(c);if(e&&c.instance===this.currentContainer&&d!=this.currentItem[0]&&this.placeholder[1==e?"next":"prev"]()[0]!=d&&!g.contains(this.placeholder[0],d)&&("semi-dynamic"==this.options.type?!g.contains(this.element[0],d):1)){this.direction=1==e?"down":"up";if("pointer"!=this.options.tolerance&&!this._intersectsWithSides(c))break;this._rearrange(a,c);this._trigger("change",a,this._uiHash());break}}return this._contactContainers(a),
g.ui.ddmanager&&g.ui.ddmanager.drag(this,a),this._trigger("sort",a,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(a,b){if(a){g.ui.ddmanager&&!this.options.dropBehaviour&&g.ui.ddmanager.drop(this,a);if(this.options.revert){var c=this,d=this.placeholder.offset();this.reverting=!0;g(this.helper).animate({left:d.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:d.top-this.offset.parent.top-this.margins.top+
(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){c._clear(a)})}else this._clear(a,b);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null});"original"==this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var a=this.containers.length-1;0<=a;a--)this.containers[a]._trigger("deactivate",null,this._uiHash(this)),this.containers[a].containerCache.over&&
(this.containers[a]._trigger("out",null,this._uiHash(this)),this.containers[a].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!=this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),g.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?g(this.domPosition.prev).after(this.currentItem):g(this.domPosition.parent).prepend(this.currentItem)),
this},serialize:function(a){var b=this._getItemsAsjQuery(a&&a.connected),c=[];return a=a||{},g(b).each(function(){var b=(g(a.item||this).attr(a.attribute||"id")||"").match(a.expression||/(.+)[-=_](.+)/);b&&c.push((a.key||b[1]+"[]")+"="+(a.key&&a.expression?b[1]:b[2]))}),!c.length&&a.key&&c.push(a.key+"="),c.join("&")},toArray:function(a){var b=this._getItemsAsjQuery(a&&a.connected),c=[];return a=a||{},b.each(function(){c.push(g(a.item||this).attr(a.attribute||"id")||"")}),c},_intersectsWith:function(a){var b=
this.positionAbs.left,c=b+this.helperProportions.width,d=this.positionAbs.top,e=d+this.helperProportions.height,k=a.left,g=k+a.width,f=a.top,j=f+a.height,h=this.offset.click.top,l=this.offset.click.left;return"pointer"==this.options.tolerance||this.options.forcePointerForContainers||"pointer"!=this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>a[this.floating?"width":"height"]?d+h>f&&d+h<j&&b+l>k&&b+l<g:k<b+this.helperProportions.width/2&&c-this.helperProportions.width/
2<g&&f<d+this.helperProportions.height/2&&e-this.helperProportions.height/2<j},_intersectsWithPointer:function(a){var b="x"===this.options.axis||g.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,a.top,a.height);a="y"===this.options.axis||g.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,a.left,a.width);b=b&&a;a=this._getDragVerticalDirection();var c=this._getDragHorizontalDirection();return b?this.floating?c&&"right"==c||"down"==a?2:1:a&&("down"==a?2:1):!1},_intersectsWithSides:function(a){var b=
g.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,a.top+a.height/2,a.height);a=g.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,a.left+a.width/2,a.width);var c=this._getDragVerticalDirection(),d=this._getDragHorizontalDirection();return this.floating&&d?"right"==d&&a||"left"==d&&!a:c&&("down"==c&&b||"up"==c&&!b)},_getDragVerticalDirection:function(){var a=this.positionAbs.top-this.lastPositionAbs.top;return 0!=a&&(0<a?"down":"up")},_getDragHorizontalDirection:function(){var a=
this.positionAbs.left-this.lastPositionAbs.left;return 0!=a&&(0<a?"right":"left")},refresh:function(a){return this._refreshItems(a),this.refreshPositions(),this},_connectWith:function(){var a=this.options;return a.connectWith.constructor==String?[a.connectWith]:a.connectWith},_getItemsAsjQuery:function(a){var b=[],c=[],d=this._connectWith();if(d&&a)for(a=d.length-1;0<=a;a--)for(var e=g(d[a]),k=e.length-1;0<=k;k--){var f=g.data(e[k],this.widgetName);f&&f!=this&&!f.options.disabled&&c.push([g.isFunction(f.options.items)?
f.options.items.call(f.element):g(f.options.items,f.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),f])}c.push([g.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):g(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(a=c.length-1;0<=a;a--)c[a][0].each(function(){b.push(this)});return g(b)},_removeCurrentsFromItems:function(){var a=this.currentItem.find(":data("+
this.widgetName+"-item)");this.items=g.grep(this.items,function(b){for(var c=0;c<a.length;c++)if(a[c]==b.item[0])return!1;return!0})},_refreshItems:function(a){this.items=[];this.containers=[this];var b=this.items,c=[[g.isFunction(this.options.items)?this.options.items.call(this.element[0],a,{item:this.currentItem}):g(this.options.items,this.element),this]],d=this._connectWith();if(d&&this.ready)for(var e=d.length-1;0<=e;e--)for(var f=g(d[e]),j=f.length-1;0<=j;j--){var h=g.data(f[j],this.widgetName);
h&&h!=this&&!h.options.disabled&&(c.push([g.isFunction(h.options.items)?h.options.items.call(h.element[0],a,{item:this.currentItem}):g(h.options.items,h.element),h]),this.containers.push(h))}for(e=c.length-1;0<=e;e--){a=c[e][1];d=c[e][0];j=0;for(f=d.length;j<f;j++)h=g(d[j]),h.data(this.widgetName+"-item",a),b.push({item:h,instance:a,width:0,height:0,left:0,top:0})}},refreshPositions:function(a){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());for(var b=this.items.length-
1;0<=b;b--){var c=this.items[b];if(!(c.instance!=this.currentContainer&&this.currentContainer&&c.item[0]!=this.currentItem[0])){var d=this.options.toleranceElement?g(this.options.toleranceElement,c.item):c.item;a||(c.width=d.outerWidth(),c.height=d.outerHeight());d=d.offset();c.left=d.left;c.top=d.top}}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(b=this.containers.length-1;0<=b;b--)d=this.containers[b].element.offset(),this.containers[b].containerCache.left=
d.left,this.containers[b].containerCache.top=d.top,this.containers[b].containerCache.width=this.containers[b].element.outerWidth(),this.containers[b].containerCache.height=this.containers[b].element.outerHeight();return this},_createPlaceholder:function(a){a=a||this;var b=a.options;if(!b.placeholder||b.placeholder.constructor==String){var c=b.placeholder;b.placeholder={element:function(){var b=g(document.createElement(a.currentItem[0].nodeName)).addClass(c||a.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];
return c||(b.style.visibility="hidden"),b},update:function(d,e){if(!c||b.forcePlaceholderSize)e.height()||e.height(a.currentItem.innerHeight()-parseInt(a.currentItem.css("paddingTop")||0,10)-parseInt(a.currentItem.css("paddingBottom")||0,10)),e.width()||e.width(a.currentItem.innerWidth()-parseInt(a.currentItem.css("paddingLeft")||0,10)-parseInt(a.currentItem.css("paddingRight")||0,10))}}}a.placeholder=g(b.placeholder.element.call(a.element,a.currentItem));a.currentItem.after(a.placeholder);b.placeholder.update(a,
a.placeholder)},_contactContainers:function(a){for(var b=null,c=null,d=this.containers.length-1;0<=d;d--)if(!g.contains(this.currentItem[0],this.containers[d].element[0]))if(this._intersectsWith(this.containers[d].containerCache)){if(!b||!g.contains(this.containers[d].element[0],b.element[0]))b=this.containers[d],c=d}else this.containers[d].containerCache.over&&(this.containers[d]._trigger("out",a,this._uiHash(this)),this.containers[d].containerCache.over=0);if(b)if(1===this.containers.length)this.containers[c]._trigger("over",
a,this._uiHash(this)),this.containers[c].containerCache.over=1;else{for(var b=1E4,d=null,e=this.containers[c].floating?"left":"top",f=this.containers[c].floating?"width":"height",j=this.positionAbs[e]+this.offset.click[e],h=this.items.length-1;0<=h;h--)if(g.contains(this.containers[c].element[0],this.items[h].item[0])&&this.items[h].item[0]!=this.currentItem[0]){var l=this.items[h].item.offset()[e],m=!1;Math.abs(l-j)>Math.abs(l+this.items[h][f]-j)&&(m=!0,l+=this.items[h][f]);Math.abs(l-j)<b&&(b=Math.abs(l-
j),d=this.items[h],this.direction=m?"up":"down")}if(d||this.options.dropOnEmpty)this.currentContainer=this.containers[c],d?this._rearrange(a,d,null,!0):this._rearrange(a,null,this.containers[c].element,!0),this._trigger("change",a,this._uiHash()),this.containers[c]._trigger("change",a,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[c]._trigger("over",a,this._uiHash(this)),this.containers[c].containerCache.over=1}},_createHelper:function(a){var b=
this.options;a=g.isFunction(b.helper)?g(b.helper.apply(this.element[0],[a,this.currentItem])):"clone"==b.helper?this.currentItem.clone():this.currentItem;return a.parents("body").length||g("parent"!=b.appendTo?b.appendTo:this.currentItem[0].parentNode)[0].appendChild(a[0]),a[0]==this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),
(""==a[0].style.width||b.forceHelperSize)&&a.width(this.currentItem.width()),(""==a[0].style.height||b.forceHelperSize)&&a.height(this.currentItem.height()),a},_adjustOffsetFromHelper:function(a){"string"==typeof a&&(a=a.split(" "));g.isArray(a)&&(a={left:+a[0],top:+a[1]||0});"left"in a&&(this.offset.click.left=a.left+this.margins.left);"right"in a&&(this.offset.click.left=this.helperProportions.width-a.right+this.margins.left);"top"in a&&(this.offset.click.top=a.top+this.margins.top);"bottom"in a&&
(this.offset.click.top=this.helperProportions.height-a.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var a=this.offsetParent.offset();"absolute"==this.cssPosition&&this.scrollParent[0]!=document&&g.contains(this.scrollParent[0],this.offsetParent[0])&&(a.left+=this.scrollParent.scrollLeft(),a.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&
g.ui.ie)a={top:0,left:0};return{top:a.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:a.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var a=this.currentItem.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins=
{left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var a=this.options;"parent"==a.containment&&(a.containment=this.helper[0].parentNode);if("document"==a.containment||"window"==a.containment)this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-
this.offset.parent.top,g("document"==a.containment?document:window).width()-this.helperProportions.width-this.margins.left,(g("document"==a.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(a.containment)){var b=g(a.containment)[0],a=g(a.containment).offset(),c="hidden"!=g(b).css("overflow");this.containment=[a.left+(parseInt(g(b).css("borderLeftWidth"),10)||0)+(parseInt(g(b).css("paddingLeft"),
10)||0)-this.margins.left,a.top+(parseInt(g(b).css("borderTopWidth"),10)||0)+(parseInt(g(b).css("paddingTop"),10)||0)-this.margins.top,a.left+(c?Math.max(b.scrollWidth,b.offsetWidth):b.offsetWidth)-(parseInt(g(b).css("borderLeftWidth"),10)||0)-(parseInt(g(b).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,a.top+(c?Math.max(b.scrollHeight,b.offsetHeight):b.offsetHeight)-(parseInt(g(b).css("borderTopWidth"),10)||0)-(parseInt(g(b).css("paddingBottom"),10)||0)-this.helperProportions.height-
this.margins.top]}},_convertPositionTo:function(a,b){b||(b=this.position);var c="absolute"==a?1:-1,d="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&g.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,e=/(html|body)/i.test(d[0].tagName);return{top:b.top+this.offset.relative.top*c+this.offset.parent.top*c-("fixed"==this.cssPosition?-this.scrollParent.scrollTop():e?0:d.scrollTop())*c,left:b.left+this.offset.relative.left*c+this.offset.parent.left*
c-("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():e?0:d.scrollLeft())*c}},_generatePosition:function(a){var b=this.options,c="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&g.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,d=/(html|body)/i.test(c[0].tagName);"relative"==this.cssPosition&&(this.scrollParent[0]==document||this.scrollParent[0]==this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset());var e=a.pageX,f=a.pageY;
this.originalPosition&&(this.containment&&(a.pageX-this.offset.click.left<this.containment[0]&&(e=this.containment[0]+this.offset.click.left),a.pageY-this.offset.click.top<this.containment[1]&&(f=this.containment[1]+this.offset.click.top),a.pageX-this.offset.click.left>this.containment[2]&&(e=this.containment[2]+this.offset.click.left),a.pageY-this.offset.click.top>this.containment[3]&&(f=this.containment[3]+this.offset.click.top)),b.grid&&(f=this.originalPageY+Math.round((f-this.originalPageY)/b.grid[1])*
b.grid[1],f=this.containment?f-this.offset.click.top<this.containment[1]||f-this.offset.click.top>this.containment[3]?f-this.offset.click.top<this.containment[1]?f+b.grid[1]:f-b.grid[1]:f:f,e=this.originalPageX+Math.round((e-this.originalPageX)/b.grid[0])*b.grid[0],e=this.containment?e-this.offset.click.left<this.containment[0]||e-this.offset.click.left>this.containment[2]?e-this.offset.click.left<this.containment[0]?e+b.grid[0]:e-b.grid[0]:e:e));return{top:f-this.offset.click.top-this.offset.relative.top-
this.offset.parent.top+("fixed"==this.cssPosition?-this.scrollParent.scrollTop():d?0:c.scrollTop()),left:e-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():d?0:c.scrollLeft())}},_rearrange:function(a,b,c,d){c?c[0].appendChild(this.placeholder[0]):b.item[0].parentNode.insertBefore(this.placeholder[0],"down"==this.direction?b.item[0]:b.item[0].nextSibling);var e=this.counter=this.counter?++this.counter:1;this._delay(function(){e==
this.counter&&this.refreshPositions(!d)})},_clear:function(a,b){this.reverting=!1;var c=[];!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem);this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var d in this._storedCSS)if("auto"==this._storedCSS[d]||"static"==this._storedCSS[d])this._storedCSS[d]="";this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!b&&c.push(function(a){this._trigger("receive",
a,this._uiHash(this.fromOutside))});(this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!b&&c.push(function(a){this._trigger("update",a,this._uiHash())});this!==this.currentContainer&&(b||(c.push(function(a){this._trigger("remove",a,this._uiHash())}),c.push(function(a){return function(b){a._trigger("receive",b,this._uiHash(this))}}.call(this,this.currentContainer)),c.push(function(a){return function(b){a._trigger("update",
b,this._uiHash(this))}}.call(this,this.currentContainer))));for(d=this.containers.length-1;0<=d;d--)b||c.push(function(a){return function(b){a._trigger("deactivate",b,this._uiHash(this))}}.call(this,this.containers[d])),this.containers[d].containerCache.over&&(c.push(function(a){return function(b){a._trigger("out",b,this._uiHash(this))}}.call(this,this.containers[d])),this.containers[d].containerCache.over=0);this._storedCursor&&g("body").css("cursor",this._storedCursor);this._storedOpacity&&this.helper.css("opacity",
this._storedOpacity);this._storedZIndex&&this.helper.css("zIndex","auto"==this._storedZIndex?"":this._storedZIndex);this.dragging=!1;if(this.cancelHelperRemoval){if(!b){this._trigger("beforeStop",a,this._uiHash());for(d=0;d<c.length;d++)c[d].call(this,a);this._trigger("stop",a,this._uiHash())}return this.fromOutside=!1,!1}b||this._trigger("beforeStop",a,this._uiHash());this.placeholder[0].parentNode.removeChild(this.placeholder[0]);this.helper[0]!=this.currentItem[0]&&this.helper.remove();this.helper=
null;if(!b){for(d=0;d<c.length;d++)c[d].call(this,a);this._trigger("stop",a,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){!1===g.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(a){var b=a||this;return{helper:b.helper,placeholder:b.placeholder||g([]),position:b.position,originalPosition:b.originalPosition,offset:b.positionAbs,item:b.currentItem,sender:a?a.element:null}}});var l=jQuery;l.widget("ui.slider",l.ui.mouse,{version:"1.9.2",widgetEventPrefix:"slide",
options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var a,b,c=this.options,d=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),e=[];this._mouseSliding=this._keySliding=!1;this._animateOff=!0;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"+(c.disabled?" ui-slider-disabled ui-disabled":
""));this.range=l([]);c.range&&(!0===c.range&&(c.values||(c.values=[this._valueMin(),this._valueMin()]),c.values.length&&2!==c.values.length&&(c.values=[c.values[0],c.values[0]])),this.range=l("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+("min"===c.range||"max"===c.range?" ui-slider-range-"+c.range:"")));b=c.values&&c.values.length||1;for(a=d.length;a<b;a++)e.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>");this.handles=d.add(l(e.join("")).appendTo(this.element));
this.handle=this.handles.eq(0);this.handles.add(this.range).filter("a").click(function(a){a.preventDefault()}).mouseenter(function(){c.disabled||l(this).addClass("ui-state-hover")}).mouseleave(function(){l(this).removeClass("ui-state-hover")}).focus(function(){c.disabled?l(this).blur():(l(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),l(this).addClass("ui-state-focus"))}).blur(function(){l(this).removeClass("ui-state-focus")});this.handles.each(function(a){l(this).data("ui-slider-handle-index",
a)});this._on(this.handles,{keydown:function(a){var b,c,d,e=l(a.target).data("ui-slider-handle-index");switch(a.keyCode){case l.ui.keyCode.HOME:case l.ui.keyCode.END:case l.ui.keyCode.PAGE_UP:case l.ui.keyCode.PAGE_DOWN:case l.ui.keyCode.UP:case l.ui.keyCode.RIGHT:case l.ui.keyCode.DOWN:case l.ui.keyCode.LEFT:if(a.preventDefault(),!this._keySliding&&(this._keySliding=!0,l(a.target).addClass("ui-state-active"),b=this._start(a,e),!1===b))return}b=this.options.step;this.options.values&&this.options.values.length?
c=d=this.values(e):c=d=this.value();switch(a.keyCode){case l.ui.keyCode.HOME:d=this._valueMin();break;case l.ui.keyCode.END:d=this._valueMax();break;case l.ui.keyCode.PAGE_UP:d=this._trimAlignValue(c+(this._valueMax()-this._valueMin())/5);break;case l.ui.keyCode.PAGE_DOWN:d=this._trimAlignValue(c-(this._valueMax()-this._valueMin())/5);break;case l.ui.keyCode.UP:case l.ui.keyCode.RIGHT:if(c===this._valueMax())return;d=this._trimAlignValue(c+b);break;case l.ui.keyCode.DOWN:case l.ui.keyCode.LEFT:if(c===
this._valueMin())return;d=this._trimAlignValue(c-b)}this._slide(a,e,d)},keyup:function(a){var b=l(a.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(a,b),this._change(a,b),l(a.target).removeClass("ui-state-active"))}});this._refreshValue();this._animateOff=!1},_destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all");
this._mouseDestroy()},_mouseCapture:function(a){var b,c,d,e,f,g,h,j,m=this,n=this.options;return n.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),b={x:a.pageX,y:a.pageY},c=this._normValueFromMouse(b),d=this._valueMax()-this._valueMin()+1,this.handles.each(function(a){var b=Math.abs(c-m.values(a));d>b&&(d=b,e=l(this),f=a)}),!0===n.range&&this.values(1)===n.min&&(f+=1,e=l(this.handles[f])),g=this._start(a,f),
!1===g?!1:(this._mouseSliding=!0,this._handleIndex=f,e.addClass("ui-state-active").focus(),h=e.offset(),j=!l(a.target).parents().andSelf().is(".ui-slider-handle"),this._clickOffset=j?{left:0,top:0}:{left:a.pageX-h.left-e.width()/2,top:a.pageY-h.top-e.height()/2-(parseInt(e.css("borderTopWidth"),10)||0)-(parseInt(e.css("borderBottomWidth"),10)||0)+(parseInt(e.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(a,f,c),this._animateOff=!0,!0))},_mouseStart:function(){return!0},
_mouseDrag:function(a){var b=this._normValueFromMouse({x:a.pageX,y:a.pageY});return this._slide(a,this._handleIndex,b),!1},_mouseStop:function(a){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(a,this._handleIndex),this._change(a,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(a){var b,
c,d,e,f;return"horizontal"===this.orientation?(b=this.elementSize.width,c=a.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(b=this.elementSize.height,c=a.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),d=c/b,1<d&&(d=1),0>d&&(d=0),"vertical"===this.orientation&&(d=1-d),e=this._valueMax()-this._valueMin(),f=this._valueMin()+d*e,this._trimAlignValue(f)},_start:function(a,b){var c={handle:this.handles[b],value:this.value()};return this.options.values&&this.options.values.length&&
(c.value=this.values(b),c.values=this.values()),this._trigger("start",a,c)},_slide:function(a,b,c){var d,e,f;this.options.values&&this.options.values.length?(d=this.values(b?0:1),2===this.options.values.length&&!0===this.options.range&&(0===b&&c>d||1===b&&c<d)&&(c=d),c!==this.values(b)&&(e=this.values(),e[b]=c,f=this._trigger("slide",a,{handle:this.handles[b],value:c,values:e}),this.values(b?0:1),!1!==f&&this.values(b,c,!0))):c!==this.value()&&(f=this._trigger("slide",a,{handle:this.handles[b],value:c}),
!1!==f&&this.value(c))},_stop:function(a,b){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values());this._trigger("stop",a,c)},_change:function(a,b){if(!this._keySliding&&!this._mouseSliding){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values());this._trigger("change",a,c)}},value:function(a){if(arguments.length)this.options.value=
this._trimAlignValue(a),this._refreshValue(),this._change(null,0);else return this._value()},values:function(a,b){var c,d,e;if(1<arguments.length)this.options.values[a]=this._trimAlignValue(b),this._refreshValue(),this._change(null,a);else{if(!arguments.length)return this._values();if(!l.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(a):this.value();c=this.options.values;d=arguments[0];for(e=0;e<c.length;e+=1)c[e]=this._trimAlignValue(d[e]),this._change(null,
e);this._refreshValue()}},_setOption:function(a,b){var c,d=0;l.isArray(this.options.values)&&(d=this.options.values.length);l.Widget.prototype._setOption.apply(this,arguments);switch(a){case "disabled":b?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.prop("disabled",!0),this.element.addClass("ui-disabled")):(this.handles.prop("disabled",!1),this.element.removeClass("ui-disabled"));break;case "orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+
this.orientation);this._refreshValue();break;case "value":this._animateOff=!0;this._refreshValue();this._change(null,0);this._animateOff=!1;break;case "values":this._animateOff=!0;this._refreshValue();for(c=0;c<d;c+=1)this._change(null,c);this._animateOff=!1;break;case "min":case "max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1}},_value:function(){var a=this.options.value;return a=this._trimAlignValue(a),a},_values:function(a){var b,c;if(arguments.length)return b=this.options.values[a],
b=this._trimAlignValue(b),b;b=this.options.values.slice();for(c=0;c<b.length;c+=1)b[c]=this._trimAlignValue(b[c]);return b},_trimAlignValue:function(a){if(a<=this._valueMin())return this._valueMin();if(a>=this._valueMax())return this._valueMax();var b=0<this.options.step?this.options.step:1,c=(a-this._valueMin())%b;a-=c;return 2*Math.abs(c)>=b&&(a+=0<c?b:-b),parseFloat(a.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var a,
b,c,d,e,f=this.options.range,g=this.options,h=this,j=this._animateOff?!1:g.animate,m={};this.options.values&&this.options.values.length?this.handles.each(function(c){b=100*((h.values(c)-h._valueMin())/(h._valueMax()-h._valueMin()));m["horizontal"===h.orientation?"left":"bottom"]=b+"%";l(this).stop(1,1)[j?"animate":"css"](m,g.animate);!0===h.options.range&&("horizontal"===h.orientation?(0===c&&h.range.stop(1,1)[j?"animate":"css"]({left:b+"%"},g.animate),1===c&&h.range[j?"animate":"css"]({width:b-a+
"%"},{queue:!1,duration:g.animate})):(0===c&&h.range.stop(1,1)[j?"animate":"css"]({bottom:b+"%"},g.animate),1===c&&h.range[j?"animate":"css"]({height:b-a+"%"},{queue:!1,duration:g.animate})));a=b}):(c=this.value(),d=this._valueMin(),e=this._valueMax(),b=e!==d?100*((c-d)/(e-d)):0,m["horizontal"===this.orientation?"left":"bottom"]=b+"%",this.handle.stop(1,1)[j?"animate":"css"](m,g.animate),"min"===f&&"horizontal"===this.orientation&&this.range.stop(1,1)[j?"animate":"css"]({width:b+"%"},g.animate),"max"===
f&&"horizontal"===this.orientation&&this.range[j?"animate":"css"]({width:100-b+"%"},{queue:!1,duration:g.animate}),"min"===f&&"vertical"===this.orientation&&this.range.stop(1,1)[j?"animate":"css"]({height:b+"%"},g.animate),"max"===f&&"vertical"===this.orientation&&this.range[j?"animate":"css"]({height:100-b+"%"},{queue:!1,duration:g.animate}))}})});;
;JCSDL.Loader.addComponent(function(b){function c(a,c){if(!(1<a.originalEvent.touches.length)){a.preventDefault();var b=a.originalEvent.changedTouches[0],d=document.createEvent("MouseEvents");d.initMouseEvent(c,!0,!0,window,1,b.screenX,b.screenY,b.clientX,b.clientY,!1,!1,!1,!1,0,null);a.target.dispatchEvent(d)}}b.support.touch="ontouchend"in document;if(b.support.touch){var d=b.ui.mouse.prototype,f=d._mouseInit,e;d._touchStart=function(a){!e&&this._mouseCapture(a.originalEvent.changedTouches[0])&&
(e=!0,this._touchMoved=!1,c(a,"mouseover"),c(a,"mousemove"),c(a,"mousedown"))};d._touchMove=function(a){e&&(this._touchMoved=!0,c(a,"mousemove"))};d._touchEnd=function(a){e&&(c(a,"mouseup"),c(a,"mouseout"),this._touchMoved||c(a,"click"),e=!1)};d._mouseInit=function(){this.element.bind("touchstart",b.proxy(this,"_touchStart")).bind("touchmove",b.proxy(this,"_touchMove")).bind("touchend",b.proxy(this,"_touchEnd"));f.call(this)}}});;
;JCSDL.Loader.addComponent(function(b){function h(a){if(a.attr("title")||"string"!=typeof a.attr("original-title"))a.attr("original-title",a.attr("title")||"").removeAttr("title")}function j(a,c){this.$element=b(a);this.options=c;this.enabled=!0;h(this.$element)}j.prototype={show:function(){var a=this.getTitle();if(a&&this.enabled){var c=this.tip();c.find(".tipsy-inner")[this.options.html?"html":"text"](a);c[0].className="tipsy";c.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).appendTo(document.body);
var a=b.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight}),d=c[0].offsetWidth,g=c[0].offsetHeight,f="function"==typeof this.options.gravity?this.options.gravity.call(this.$element[0]):this.options.gravity,e;switch(f.charAt(0)){case "n":e={top:a.top+a.height+this.options.offset,left:a.left+a.width/2-d/2};break;case "s":e={top:a.top-g-this.options.offset,left:a.left+a.width/2-d/2};break;case "e":e={top:a.top+a.height/2-g/2,left:a.left-d-this.options.offset};
break;case "w":e={top:a.top+a.height/2-g/2,left:a.left+a.width+this.options.offset}}2==f.length&&(e.left="w"==f.charAt(1)?a.left+a.width/2-15:a.left+a.width/2-d+15);c.css(e).addClass("tipsy-"+f);this.options.fade?c.stop().css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:this.options.opacity}):c.css({visibility:"visible",opacity:this.options.opacity})}},hide:function(){this.options.fade?this.tip().stop().fadeOut(function(){b(this).remove()}):this.tip().remove()},getTitle:function(){var a,
b=this.$element,d=this.options;h(b);d=this.options;"string"==typeof d.title?a=b.attr("title"==d.title?"original-title":d.title):"function"==typeof d.title&&(a=d.title.call(b[0]));return(a=(""+a).replace(/(^\s*|\s*$)/,""))||d.fallback},tip:function(){this.$tip||(this.$tip=b('<div class="tipsy"></div>').html('<div class="tipsy-arrow"></div><div class="tipsy-inner"/></div>'));return this.$tip},validate:function(){this.$element[0].parentNode||(this.hide(),this.options=this.$element=null)},enable:function(){this.enabled=
!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled}};b.fn.tipsy=function(a){function c(c){var d=b.data(c,"tipsy");d||(d=new j(c,b.fn.tipsy.elementOptions(c,a)),b.data(c,"tipsy",d));return d}function d(){var b=c(this);b.hoverState="in";0==a.delayIn?b.show():setTimeout(function(){"in"==b.hoverState&&b.show()},a.delayIn)}function g(){var b=c(this);b.hoverState="out";0==a.delayOut?b.hide():setTimeout(function(){"out"==b.hoverState&&b.hide()},a.delayOut)}if(!0===
a)return this.data("tipsy");if("string"==typeof a)return this.data("tipsy")[a]();a=b.extend({},b.fn.tipsy.defaults,a);a.live||this.each(function(){c(this)});if("manual"!=a.trigger){var f=a.live?"live":"bind",e="hover"==a.trigger?"mouseleave":"blur";this[f]("hover"==a.trigger?"mouseenter":"focus",d)[f](e,g)}return this};b.fn.tipsy.defaults={delayIn:0,delayOut:0,fade:!1,fallback:"",gravity:"n",html:!1,live:!1,offset:0,opacity:0.8,title:"title",trigger:"hover"};b.fn.tipsy.elementOptions=function(a,c){return b.metadata?
b.extend({},c,b(a).metadata()):c};b.fn.tipsy.autoNS=function(){return b(this).offset().top>b(document).scrollTop()+b(window).height()/2?"s":"n"};b.fn.tipsy.autoWE=function(){return b(this).offset().left>b(document).scrollLeft()+b(window).width()/2?"e":"w"}});;
;JCSDL.Loader.addComponent(function(e){e.fn.extend({simulate:function(c,d){return this.each(function(){var b=e.extend({},e.simulate.defaults,d||{});new e.simulate(this,c,b)})}});e.simulate=function(c,d,b){this.target=c;this.options=b;/^drag$/.test(d)?this[d].apply(this,[this.target,b]):this.simulateEvent(c,d,b)};e.extend(e.simulate.prototype,{simulateEvent:function(c,d,b){var a=this.createEvent(d,b);this.dispatchEvent(c,d,a,b);return a},createEvent:function(c,d){if(/^mouse(over|out|down|up|move)|(dbl)?click$/.test(c))return this.mouseEvent(c,
d);if(/^key(up|down|press)$/.test(c))return this.keyboardEvent(c,d)},mouseEvent:function(c,d){var b,a=e.extend({bubbles:!0,cancelable:"mousemove"!=c,view:window,detail:0,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},d);e(a.relatedTarget);e.isFunction(document.createEvent)?(b=document.createEvent("MouseEvents"),b.initMouseEvent(c,a.bubbles,a.cancelable,a.view,a.detail,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,
a.metaKey,a.button,a.relatedTarget||document.body.parentNode)):document.createEventObject&&(b=document.createEventObject(),e.extend(b,a),b.button={"0":1,1:4,2:2}[b.button]||b.button);return b},keyboardEvent:function(c,d){var b,a=e.extend({bubbles:!0,cancelable:!0,view:window,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:0,charCode:0},d);if(e.isFunction(document.createEvent))try{b=document.createEvent("KeyEvents"),b.initKeyEvent(c,a.bubbles,a.cancelable,a.view,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,
a.keyCode,a.charCode)}catch(g){b=document.createEvent("Events"),b.initEvent(c,a.bubbles,a.cancelable),e.extend(b,{view:a.view,ctrlKey:a.ctrlKey,altKey:a.altKey,shiftKey:a.shiftKey,metaKey:a.metaKey,keyCode:a.keyCode,charCode:a.charCode})}else document.createEventObject&&(b=document.createEventObject(),e.extend(b,a));if(e.browser.msie||e.browser.opera)b.keyCode=0<a.charCode?a.charCode:a.keyCode,b.charCode=void 0;return b},dispatchEvent:function(c,d,b){c.dispatchEvent?c.dispatchEvent(b):c.fireEvent&&
c.fireEvent("on"+d,b);return b},drag:function(){var c=this.findCenter(this.target),d=this.options,b=Math.floor(c.x),c=Math.floor(c.y),a=d.dx||0,d=d.dy||0,e=this.target,f={clientX:b,clientY:c};this.simulateEvent(e,"mousedown",f);f={clientX:b+1,clientY:c+1};this.simulateEvent(document,"mousemove",f);f={clientX:b+a,clientY:c+d};this.simulateEvent(document,"mousemove",f);this.simulateEvent(document,"mousemove",f);this.simulateEvent(e,"mouseup",f)},findCenter:function(c){c=e(this.target);var d=c.offset();
return{x:d.left+c.outerWidth()/2,y:d.top+c.outerHeight()/2}}});e.extend(e.simulate,{defaults:{speed:"sync"},VK_TAB:9,VK_ENTER:13,VK_ESC:27,VK_PGUP:33,VK_PGDN:34,VK_END:35,VK_HOME:36,VK_LEFT:37,VK_UP:38,VK_RIGHT:39,VK_DOWN:40})});;
;JCSDL.Loader.addComponent(function(g,k){this.Parser=function(a){this.gui=a};this.Parser.prototype={v:"2.0",parseJCSDL:function(a){var b=a.split("\n"),e=b.shift();b.pop();if(!this.verifyJCSDL(e,b))throw new JCSDL.ValidationException("The given JCSDL did not verify!",a);a=b.shift().split(" ")[2];var e=e.split(" ")[3],c=[];for("//"!==b[0].substr(0,2)&&b.shift();1<b.length;){var d=b.shift(),f=b.shift();b.shift();b.shift();var d=d.split(" "),g=d[3],j=d[4]||c.length+1;if(!this.verifyJCSDLFilter(d[2],f))throw new JCSDL.ValidationException("The given JCSDL Filter code did not verify!",
f);d=this.filterFromJCSDL(g,f,j,a);c.push(d)}return{filters:c,logic:e}},filterFromJCSDL:function(a,b,e,c){c=c||this.v;c!==this.v&&(a=this.applyFilterJCSDLTransformers(a,c));a=a.split(",");c=a.shift().split(".");var d=c.shift(),f=this.getFieldInfo(d,c);if(!1===f)return!1;var h=a.shift(),j="",l={cs:!1};"exists"!==h&&(j=a.shift().split("-"),j=this.valueFromCSDL(f,b.substr(j[0],j[1]),h),g.each(a,function(a,b){switch(b){case "cs":l.cs=!0}}));return this.createFilter(d,c,h,j,l,e)},getJCSDLForFilters:function(a,
b){var e=this,c={},d=[],f="";g.each(a,function(a,b){var d=e.filterToCSDL(b);if(!d)return!0;c[b.id+""]=d});if("AND"!=b&&"OR"!=b){var f=this.tokenizeLogicString(b),h="";this.validateLogic(f,a);g.each(f,function(a,b){if("number"===typeof b)if(h.length&&d.push(g.trim(h)),h="",c[b+""]!==k)d.push(c[b+""]);else throw new JCSDL.LogicValidationException("A filter with ID '"+b+"' doesn't exist! You cannot use it in a logical expression",a);else h="&"==b||"|"==b?h+("|"==b?" OR ":" AND "):h+b});h.length&&d.push(g.trim(h));
f=d.join("\n")}else g.each(c,function(a,b){d.push(b)}),f=d.join("\n"+b+"\n");f="// JCSDL_VERSION "+this.v+"\n"+f;return f="// JCSDL_MASTER "+this.encodeJCSDL(f,b)+" "+b+"\n"+f+"\n// JCSDL_MASTER_END"},filterToCSDL:function(a){var b=this.getFieldInfo(a.target,a.fieldPath);if(!1===b)return!1;var e=this.valueToCSDL(a.value,b,a.operator);if(!1===e)return!1;var c=this.fieldToCSDL(a.fieldPath);if(!1===c)return!1;var d=this.getOperatorCode(a.operator);if(!1===d)return!1;var f=a.cs?" cs":"",d=("augmentation"==
a.target?"":a.target+".")+c.replace("-",".")+f+" "+d+" ",c=a.target+"."+c+","+a.operator;"exists"!==a.operator&&(f="string"==b.type||"geo"==b.type?d.length+1:d.length,b="string"==b.type||"geo"==b.type?e.length-2:e.length,d+=e,c+=","+f+"-"+b,a.cs&&(c+=",cs"));return[["// JCSDL_START",this.encodeJCSDLFilter(d),c,a.id].join(" "),d,"// JCSDL_END"].join("\n")},encodeJCSDL:function(a,b){return Crypto.MD5(b+"\n"+a)},verifyJCSDL:function(a,b){var e=b.join("\n"),c=a.split(" "),d=c[2],e=this.encodeJCSDL(e,
c[3]);return d==e},encodeJCSDLFilter:function(a){return Crypto.MD5(a)},verifyJCSDLFilter:function(a,b){return a==this.encodeJCSDLFilter(b)},fieldToCSDL:function(a){return a.join(".")},valueToCSDL:function(a,b,e){var c="";if("int"==b.type||"float"==b.type){if("in"!==e&&isNaN(a))return this.error("This field value is suppose to be a Number, String given.",a,b),!1;"in"==e?(a=a.split(","),g.each(a,function(b,c){a[b]=parseInt(c)}),c="["+a.join(",")+"]"):c=a}else b=0<=g.inArray(e,["regex_partial","regex_exact"])?
!0:!1,c='"'+a.escapeCsdl(b)+'"';return c},valueFromCSDL:function(a,b,e){if("int"==a.type)return"in"==e&&(b=b.substr(1,b.length-2)),b;a=0<=g.inArray(e,["regex_partial","regex_exact"])?!0:!1;return b.unescapeCsdl(a)},tokenizeLogicString:function(a){a=(""+a).replace(/\s+/g,"");for(var b=[],e=!1,c=0;c<a.length;c++){var d=a.charAt(c);d.isNumeric()?(e?(b[b.length-1]+=""+d,b[b.length-1]=parseInt(b[b.length-1])):b.push(parseInt(d)),e=!0):(b.push(d),e=!1)}return b},validateLogic:function(a,b){var e="string"===
typeof a||"number"===typeof a?this.tokenizeLogicString(a):a;if(0<=g.inArray(e[0],["&","|"]))throw new JCSDL.LogicValidationException('Logical query cannot start with logical operator "'+e[0]+'"!',0);if(0<=g.inArray(e[e.length-1],["&","|"]))throw new JCSDL.LogicValidationException('Logical query cannot end with logical operator "'+e[e.length-1]+'"!',e.length-1);var c=null,d=[],f=0,h=[];b&&b.length&&g.each(b,function(a,b){h.push(parseInt(b.id))});g.each(e,function(a,b){if("("==b&&")"==c)throw new JCSDL.LogicValidationException('You cannot use opening parenthesis "(" right after a closing parenthesis ")"!',
a);if(")"==b&&"("==c)throw new JCSDL.LogicValidationException('You cannot use closing parenthesis ")" right after an opening parenthesis "("!',a);if(")"==b&&0<=g.inArray(c,["&","|"]))throw new JCSDL.LogicValidationException('You cannot use closing parenthesis ")" right after a logical operator!',a);if(0<=g.inArray(b,["&","|"])&&"("==c)throw new JCSDL.LogicValidationException('You cannot use logical operator "'+b+'" right after opening brackets!',a);if("("==b&&"number"==typeof c)throw new JCSDL.LogicValidationException('You cannot open a parenthesis right after filter ID! You need to use a logical operator "&" or "|"!',
a);if("number"==typeof b&&")"==c)throw new JCSDL.LogicValidationException('You cannot use filter ID right after closing a parenthesis! You need to use a logical operator "&" or "|"!',a);if(0<=g.inArray(b,["&","|"])&&0<=g.inArray(c,["&","|"]))throw new JCSDL.LogicValidationException("You cannot use two logical operators next to each other!",a);if("number"==typeof b){if("number"==typeof c)throw new JCSDL.LogicValidationException("Cannot use two filter ID's next to each other!",a);if(-1==g.inArray(b,
h))throw new JCSDL.LogicValidationException('The filter ID "'+b+"\" doesn't exist! You can only use filters from the list of filters.",a);if(0<=g.inArray(b,d))throw new JCSDL.LogicValidationException('The filter with ID "'+b+'" has already been used in the logical expression! You can only use one filter once.',a);d.push(b)}if(0<=g.inArray(b,["(",")"])&&(f="("==b?f+1:f-1,0>f))throw new JCSDL.LogicValidationException("Parentheses do not create a logical expression, i.e. there are too many closing parenthesis that close a nested expression that was never opened!",
a);c=b});var j=[];g.each(h,function(b,a){-1==g.inArray(a,d)&&j.push(a)});if(j.length)throw new JCSDL.LogicValidationException("You haven't used some of the filters in your logical expression (with ID's: \""+j.join('", "')+'"). All filters need to be used!');if(0!==f)throw new JCSDL.LogicValidationException("You have't closed some parentheses!");return!0},error:function(a,b){this.gui.showError.apply(this.gui,arguments)},createFilter:function(a,b,e,c,d,f){d=d||{};return{id:f,target:a,fieldPath:b,operator:e,
value:c,cs:d.cs}},getOperatorCode:function(a){return this.gui.definition.operators[a].code},getTargetInfo:function(a){if(this.gui.definition.targets[a]!==k)return this.gui.definition.targets[a];this.error("Such target does not exist!",a);return!1},getFieldInfo:function(a,b){var e=this,c=this.gui.definition.targets[a];if(c===k)return this.error("Such target does not exist!",a),!1;g.each(b,function(d,f){if(c.fields!==k)if(c.fields[f]!==k)c=c.fields[f];else return e.error("Invalid path to a field (#1)!",
a,b,c),c=!1;else return e.error("Invalid path to a field (#2)!",a,b,c),c=!1});return c},transformers:[{from:"1.0",to:"2.0",filter:function(a){a=a.split(",");"augmentation.language-tag"===a[0]&&(a[0]="augmentation.language.tag");return a.join(",")}}],applyFilterJCSDLTransformers:function(a,b){var e=!1,c=a;g.each(this.transformers,function(d,f){if(e||f.from===b)e=!0,"function"===typeof f.filter&&(c=f.filter(a))});return c}};this.ValidationException=function(a,b){this.message=a;this.code=b};this.LogicValidationException=
function(a,b){this.message=a;this.index=b}});;
;JCSDL.Loader.addComponent(function(a){this.GUITemplates={container:a('<div class="jcsdl-container" />'),editor:a('<div class="jcsdl-mainview"><div class="jcsdl-header"><div class="jcsdl-row"><h3>Filters</h3><div class="jcsdl-actions"><a href="#" class="jcsdl-button jcsdl-elements-sprite jcsdl-editor-save">Save and Preview</a><a href="#" class="jcsdl-button jcsdl-elements-sprite jcsdl-editor-cancel">Cancel</a></div></div><div class="jcsdl-advanced-container jcsdl-bordered" style="display: none;"><div class="jcsdl-advanced-gui-container"><ul class="jcsdl-advanced-gui" /><a href="#" class="jcsdl-advanced-gui-arrow left off"><span class="jcsdl-elements-sprite" /></a><a href="#" class="jcsdl-advanced-gui-arrow right off"><span class="jcsdl-elements-sprite" /></a></div><div class="jcsdl-advanced-manual" style="display: none;"><input type="text" name="advanced" placeholder="1&(2|3)..." /></div></div><div class="jcsdl-row"><div class="jcsdl-filters-logic"><a href="#" class="jcsdl-btn jcsdl-filters-logic-option jcsdl-and active disabled" data-logic="AND" data-text-long="ALL of the following" data-text-short="ALL">ALL of the following</a><a href="#" class="jcsdl-btn jcsdl-filters-logic-option jcsdl-or disabled" data-logic="OR" data-text-long="ANY of the following" data-text-short="ANY">ANY of the following</a><a href="#" class="jcsdl-btn jcsdl-filters-logic-option jcsdl-advanced disabled" data-logic="ADVANCED">ADVANCED<span class="jcsdl-logic-help" data-text-general="Use the advanced option to create logical expressions." data-text-gui="Drag and drop the tiles to create an advanced query." data-text-manual="Type a logical expression to create an advanced query.">?</span></a><a href="#" class="jcsdl-btn jcsdl-filters-logic-option jcsdl-advanced-option jcsdl-advanced-add-brackets">+ [ ]</a><a href="#" class="jcsdl-btn jcsdl-filters-logic-option jcsdl-advanced-option jcsdl-advanced-manual-edit" data-text-gui="Manual Edit" data-text-manual="Graphical Edit">Manual Edit</a></div><div class="jcsdl-mainview-actions"><a href="#" class="jcsdl-btn jcsdl-mainview-action jcsdl-add-filter"><div class="jcsdl-picto jcsdl-elements-sprite"></div>Create New Filter</a></div><div class="jcsdl-mainview-mode"><div class="jcsdl-label">View as:</div><div class="jcsdl-bordered jcsdl-mainview-mode-options"><a href="#" class="jcsdl-mainview-mode-option jcsdl-elements-sprite jcsdl-expanded active" data-mode="expanded"></a><a href="#" class="jcsdl-mainview-mode-option jcsdl-elements-sprite jcsdl-collapsed" data-mode="collapsed"></a></div></div></div></div><div class="jcsdl-filters-list expanded" /><div class="jcsdl-footer"><div class="jcsdl-actions"><a href="#" class="jcsdl-button jcsdl-elements-sprite jcsdl-editor-save">Save and Preview</a><a href="#" class="jcsdl-button jcsdl-elements-sprite jcsdl-editor-cancel">Cancel</a></div><div class="jcsdl-mainview-actions"><a href="#" class="jcsdl-btn jcsdl-mainview-action jcsdl-add-filter"><div class="jcsdl-picto jcsdl-elements-sprite"></div>Create New Filter</a></div></div></div>'),
filter:a('<div class="jcsdl-filter"><div class="jcsdl-filter-description"><div class="jcsdl-filter-info jcsdl-bordered id" /><div class="jcsdl-filter-info target" /><div class="jcsdl-filter-info field" /><div class="jcsdl-filter-info operator" /><div class="jcsdl-filter-info jcsdl-bordered value" /></div><div class="jcsdl-filter-options"><a href="#" class="edit">Edit</a><span>/</span><a href="#" class="delete">Delete</a></div></div>'),filterTarget:a('<div class="jcsdl-filter-target jcsdl-icon target" />'),
filterField:a('<div class="jcsdl-filter-field jcsdl-icon field" />'),filterFieldInput:a('<div class="jcsdl-filter-info input"><div class="jcsdl-filter-field-input jcsdl-icon input" /></div>'),filterOperator:a('<div class="jcsdl-filter-operator jcsdl-icon operator" />'),filterValue:a('<div class="jcsdl-filter-value" />'),error:a('<div class="jcsdl-error jcsdl-elements-sprite"><strong>Error:</strong><span /></div>'),logicToken_operatorAnd:a('<div href="#" class="jcsdl-logic-token operator" data-token="&">AND</div>'),
logicToken_operatorOr:a('<div href="#" class="jcsdl-logic-token operator" data-token="|">OR</div>'),logicToken_bracketOpen:a('<div href="#" class="jcsdl-logic-token bracket" data-token="(">[<a href="#" class="jcsdl-delete-token"><span class="jcsdl-elements-sprite"/ ></a></div>'),logicToken_bracketClose:a('<div href="#" class="jcsdl-logic-token bracket" data-token=")">]<a href="#" class="jcsdl-delete-token"><span class="jcsdl-elements-sprite" /></a></div>'),logicToken_filter:a('<div href="#" class="jcsdl-logic-token filter" data-token="#">#</div>'),
filterEditor:a('<div class="jcsdl-filter-editor"><div class="jcsdl-steps"></div><div class="jcsdl-footer"><a href="#" class="jcsdl-button jcsdl-elements-sprite jcsdl-filter-save">Save and Preview</a><span style="display: none;">or</span> <a href="#" class="jcsdl-filter-cancel">cancel</a></div></div>'),step:a('<div class="jcsdl-step" />'),target:a('<div class="jcsdl-filter-target-wrap"><a href="#" class="jcsdl-carousel-scroll jcsdl-elements-sprite left"></a><a href="#" class="jcsdl-carousel-scroll jcsdl-elements-sprite right"></a><div class="jcsdl-carousel-wrap"><div class="jcsdl-filter-target jcsdl-carousel" /></div></div>'),
targetOption:a('<a href="#" class="jcsdl-icon target jcsdl-carousel-item"></a>'),field:a('<div class="jcsdl-filter-target-field-wrap"><a href="#" class="jcsdl-carousel-scroll jcsdl-elements-sprite left"></a><a href="#" class="jcsdl-carousel-scroll jcsdl-elements-sprite right"></a><div class="jcsdl-carousel-wrap"><div class="jcsdl-filter-target-field jcsdl-carousel" /></div></div>'),fieldOption:a('<a href="#" class="jcsdl-icon field jcsdl-carousel-item" />'),inputSelect:a('<div class="jcsdl-filter-target-field-input-wrap"><a href="#" class="jcsdl-carousel-scroll jcsdl-elements-sprite left"></a><a href="#" class="jcsdl-carousel-scroll jcsdl-elements-sprite right"></a><div class="jcsdl-carousel-wrap"><div class="jcsdl-filter-target-field-input jcsdl-carousel" /></div></div>'),
inputSelectOption:a('<a href="#" class="jcsdl-icon input jcsdl-carousel-item" />'),targetHelp:a('<a href="#" class="jcsdl-target-help">Learn More</a>'),valueInput:a('<div class="jcsdl-filter-value-input"><div class="jcsdl-filter-value-input-operators" /><div class="jcsdl-filter-value-input-field" /></div>'),operatorOption:a('<a href="#" class="jcsdl-icon operator" />'),textOperatorsSelect:a('<div class="jcsdl-operators-select"><div class="jcsdl-operator-label" /><div class="jcsdl-dropdown-icon jcsdl-elements-sprite" /></div>'),
textOperatorsDropdown:a('<div class="jcsdl-dropdown jcsdl-operators-dropdown" />'),textOperatorOption:a('<div class="jcsdl-dropdown-option"><div class="jcsdl-icon operator" /><a href="#" class="jcsdl-dropdown-details-trigger jcsdl-elements-sprite">?</a><div class="jcsdl-dropdown-option-desc"><div class="jcsdl-operator-label"><span /> <a href="#" class="jcsdl-operator-help">(?)</a></div><div class="jcsdl-operator-desc" /></div></div>'),caseSensitivity:a('<a class="jcsdl-operator-cs jcsdl-icon icon-cs operator" title="Case Sensitive" />'),
valueInput_text:a('<div class="jcsdl-input-text"><input type="text" placeholder="Type your desired value..." class="orig" /><div class="jcsdl-containsnear-distance"><span>Distance:</span><input type="text" placeholder="e.g. 0" value="2" class="dist" /></div></div>'),valueInput_number:a('<div class="jcsdl-input-number"><input type="text" placeholder="e.g. 3.14" /></div>'),valueInput_select:a('<div class="jcsdl-input-select" />'),valueInput_select_option:a('<a href="#" class="jcsdl-btn jcsdl-input-select-option"><span /></a>'),
valueInput_select_more:a('<span class="jcsdl-input-select-more">and <span class="count"></span> more...</span>'),valueInput_slider:a('<div class="jcsdl-input-slider"><div class="jcsdl-slider-controls"><a href="#" class="jcsdl-slider-minus jcsdl-elements-sprite" /><a href="#" class="jcsdl-slider-plus jcsdl-elements-sprite" /><input type="text" name="value" class="jcsdl-slider-input" placeholder="0" /></div><div class="jcsdl-slider-wrap"><div class="jcsdl-slider-icon min" /><div class="jcsdl-slider-icon max" /><div class="jcsdl-slider-container"><div class="jcsdl-slider-label min" /><div class="jcsdl-slider-label max" /><div class="jcsdl-slider jcsdl-elements-sprite" /><div class="jcsdl-slider-bottom"><div class="jcsdl-slider-bottom-left jcsdl-elements-sprite" /><div class="jcsdl-slider-bottom-right jcsdl-elements-sprite" /><div class="jcsdl-slider-bottom-line jcsdl-elements-sprite" /></div></div></div></div>'),
valueInput_geo_map:a('<div class="jcsdl-map"><input type="text" name="location" class="jcsdl-map-search" placeholder="Search for location..." /><div class="jcsdl-map-canvas" /><a href="#" class="jcsdl-clear-map">clear coordinates</a><p class="jcsdl-map-instructions" /><div class="jcsdl-map-coordinates" /><div class="jcsdl-map-area"><label>Area:</label><span>0 km<sup>2</sup></span></div></div>'),valueInput_geobox:a('<div class="jcsdl-input-geo jcsdl-geo-box" />'),valueInput_geobox_coordinates:a('<ul><li class="nw"><label>NW:</label><span /></li><li class="ne"><label>NE:</label><span /></li><li class="se"><label>SE:</label><span /></li><li class="sw"><label>SW:</label><span /></li></ul>'),
valueInput_georadius:a('<div class="jcsdl-input-geo jcsdl-geo-radius" />'),valueInput_georadius_coordinates:a('<ul><li class="center"><label>Center:</label><span /></li><li class="radius"><label>Radius:</label><span /></li></ul>'),valueInput_geopolygon:a('<div class="jcsdl-input-geo jcsdl-geo-polygon" />'),valueInput_geopolygon_coordinates:a("<ul />")}});;
;JCSDL.Loader.addComponent(function(j,m){this.GUIInputs=function(b){this.gui=b;this.definition=b.definition;this.getTemplate=b.getTemplate};this.GUIInputs.prototype={exec:function(b,a,c){return this[b][a].apply(this,c)},text:{init:function(){var b=this.getTemplate("valueInput_text"),a=b.find("input.orig");a.jcsdlTagInput();a.jcsdlRegExTester();b.find("input.dist").jcsdlNumberMask();return b},setValue:function(b,a,c,d){"contains_near"==d&&(c=c.split(":"),a=parseInt(c.pop()),b.find("input.dist").val(a),
c=c.join(":").replace(/\\:/g,":"));b.find("input.orig").val(c)},getValue:function(b,a,c){a=b.find("input.orig").val();"contains_near"==c&&(a=a.replace(/:/g,"\\:")+":"+parseInt(b.find("input.dist").val()));return a},displayValue:function(b,a,c){return"contains_near"==c.operator?(a=a.split(":"),b=parseInt(a.pop()),a=a.join(":").truncate(50,"...",!0).escapeHtml(),a+" : "+b):a.truncate(50,"...",!0).escapeHtml()}},number:{init:function(b){var a=this.getTemplate("valueInput_number"),c="float"==b.type;b=
0<=j.inArray("in",b.operators);var d=a.find("input[type=text]");d.jcsdlNumberMask(c);b&&d.jcsdlTagInput({numbers:!0,floats:c});return a},setValue:function(b,a,c){b.find("input[type=text]:first").val(c)},getValue:function(b){return b.find("input[type=text]:first").val()},displayValue:function(b,a,c){if("in"!==c.operator)return a;var d="float"==b.type;a=a.split(",");var e=a.slice(0,3);j.each(e,function(a,c){e[a]=d?parseFloat(c).format(2):c});b=e.length<a.length?" and "+(a.length-e.length)+" more...":
"";return e.join(", ")+b}},select:{init:function(b){var a=this,c=this.getTemplate("valueInput_select"),d=this.exec("select","getOptionsSet",[b]);j.each(d,function(b,d){a.exec("select","createOptionView",[b,d]).appendTo(c)});c.find(".jcsdl-input-select-option").bind("click touchstart",function(a){a.preventDefault();a.target.blur();b.single&&c.find(".jcsdl-input-select-option").removeClass("selected");j(this).toggleClass("selected")});return c},setValue:function(b,a,c){a=c.split(",");j.each(a,function(a,
c){b.find(".jcsdl-input-select-option.option-"+c).addClass("selected")})},getValue:function(b){var a=[];b.find(".jcsdl-input-select-option.selected").each(function(c,b){a.push(j(b).data("value"))});return a.join(",")},displayValue:function(b,a){var c=this,d=a.split(","),e=this.getTemplate("valueInput_select");if(0==d.length)return e;var f=this.exec("select","getOptionsSet",[b]),h=d.slice(0,5);j.each(h,function(a,b){if(f[b]===m)return!0;c.exec("select","createOptionView",[b,f[b]]).addClass("selected").appendTo(e)});
if(d.length>h.length){var g=this.getTemplate("valueInput_select_more");g.find(".count").html(d.length-h.length);g.appendTo(e)}e.find(".jcsdl-input-select-option").bind("click touchstart",function(a){a.preventDefault();a.target.blur()});return e},getOptionsSet:function(b){var a={};b.options!==m?a=b.options:b.optionsSet!==m&&this.definition.inputs.select.sets[b.optionsSet]!==m&&(a=this.definition.inputs.select.sets[b.optionsSet]);return a},createOptionView:function(b,a){var c=this.getTemplate("valueInput_select_option").data("value",
b).addClass("option-"+b).attr("title",a);c.find("span").html(a);return c}},slider:{init:function(b){var a=this,c=this.getTemplate("valueInput_slider"),d=this.exec("slider","getOptions",[b]);c.find(".jcsdl-slider").slider({animate:!0,min:d.min,max:d.max,step:d.step,value:d["default"],slide:function(d,e){c.find(".jcsdl-slider-input").val(a.exec("slider","parseValue",[b,e.value]))}});this.exec("slider","setValue",[c,b,d["default"]]);c.find(".jcsdl-slider-label.min").html(this.exec("slider","displayValue",
[b,d.min]));c.find(".jcsdl-slider-label.max").html(this.exec("slider","displayValue",[b,d.max]));c.find(".jcsdl-slider-input").jcsdlNumberMask("float"==b.type).keyup(function(d){110==d.which||190==d.which||(d=j(this).val(),a.exec("slider","setValue",[c,b,parseFloat(d?d:0)]))});var e=null;c.find(".jcsdl-slider-minus, .jcsdl-slider-plus").bind("mousedown touchstart",function(){var f=j(this).is(".jcsdl-slider-minus");e=setInterval(function(){var e=d.step,g=parseFloat(c.find(".jcsdl-slider-input").val()),
g=f?g-e:g+e;a.exec("slider","setValue",[c,b,g])},50)}).bind("mouseup mouseout touchend",function(){clearInterval(e)}).click(function(a){a.preventDefault();a.target.blur()});return c},setValue:function(b,a,c){a=this.exec("slider","getOptions",[a]);c=c>a.max?a.max:c<a.min?a.min:c;b.find(".jcsdl-slider").slider("value",c);b.find(".jcsdl-slider-input").val(c)},getValue:function(b,a){return this.exec("slider","parseValue",[a,b.find(".jcsdl-slider-input").val()])},displayValue:function(b,a){var c=this.exec("slider",
"getOptions",[b]);return c.displayFormat.apply(c,[a.toString()])},parseValue:function(b,a){return a},getOptions:function(b){return j.extend({},this.definition.inputs.slider,{min:b.min,max:b.max,step:b.step,"default":b["default"],displayFormat:b.displayFormat})}},_geo:{mapOptions:{},initSearch:function(b){var a=b.data("map"),c=b.find(".jcsdl-map-search"),d=new google.maps.places.Autocomplete(c[0],{});google.maps.event.addListener(d,"place_changed",function(){var b=d.getPlace();b.geometry===m?0<j(".pac-container .pac-item").length&&
(c.trigger("focus"),c.simulate("keydown",{keyCode:40}),c.simulate("keydown",{keyCode:13})):b.geometry.viewport?a.fitBounds(b.geometry.viewport):(a.setCenter(b.geometry.location),a.setZoom(17))})},isNorth:function(b,a){return b.lat()>=a.lat()},isEast:function(b,a){return b.lng()>=a.lng()}},geo_box:{init:function(b){var a=this.getTemplate("valueInput_geobox");a.append(this.getTemplate("valueInput_geo_map"));a.find(".jcsdl-map-coordinates").html(this.getTemplate("valueInput_geobox_coordinates"));a.find(".jcsdl-map-instructions").html(this.definition.inputs.geo_box.instructions[0]);
loadGoogleMapsApi(this.gui,this.exec,["geo_box","load",[b,a]]);return a},load:function(b,a){var c=this,d=new google.maps.Map(a.find(".jcsdl-map-canvas")[0],jcsdlMapsOptions);a.data("map",d);var e=new google.maps.Rectangle(j.extend({},this.gui.config.mapsOverlay,{}));a.data("rect",e);var f=[],h={position:new google.maps.LatLng(0,0),draggable:!0,icon:this.gui.config.mapsMarker},g=[new google.maps.Marker(h),new google.maps.Marker(h)];a.data("markers",g);this._geo.initSearch(a);google.maps.event.addListener(d,
"click",function(b){2<=f.length&&f.pop();f.push(b.latLng);var k=f.length-1;g[k].setPosition(b.latLng);a.data("bothMarkersVisible")||g[k].setAnimation(google.maps.Animation.DROP);g[k].setMap(d);2==f.length&&(c.exec("geo_box","drawRectangle",[d,e,f]),a.data("bothMarkersVisible",!0));a.find(".jcsdl-map-instructions").html(c.definition.inputs.geo_box.instructions[f.length]);a.find(".jcsdl-clear-map").fadeIn()});google.maps.event.addListener(g[0],"position_changed",function(){f[0]=this.getPosition();c.exec("geo_box",
"drawRectangle",[d,e,f]);2==f.length&&c.exec("geo_box","updateInfo",[a,e])});google.maps.event.addListener(g[1],"position_changed",function(){f[1]=this.getPosition();c.exec("geo_box","drawRectangle",[d,e,f]);c.exec("geo_box","updateInfo",[a,e])});a.find(".jcsdl-clear-map").bind("click touchstart",function(b){b.preventDefault();b.target.blur();f=[];e.setMap(null);g[0].setMap(null);g[1].setMap(null);a.data("bothMarkersVisible",!1);a.find(".jcsdl-map-area span").html("0 km<sup>2</sup>");a.find(".jcsdl-map-instructions").html(c.definition.inputs.geo_box.instructions[0]);
j(this).hide()})},setValue:function(b,a,c){var d=this,e=b.find(".jcsdl-input-geo");c=c.split(":");var f=c[0].split(","),h=c[1].split(",");setTimeout(function(){var a=e.data("map"),c=e.data("rect"),k=d.exec("geo_box","getAllTipsFromNWSE",[f,h]),l=new google.maps.LatLngBounds(k.sw,k.ne);d.exec("geo_box","drawRectangleFromBounds",[a,c,l]);l=e.data("markers");l[0].setMap(a);l[0].setPosition(k.ne);l[1].setMap(a);l[1].setPosition(k.sw);a.fitBounds(c.getBounds());d.exec("geo_box","updateInfo",[e,c]);b.find(".jcsdl-map-instructions").html(d.definition.inputs.geo_box.instructions[2]);
b.find(".jcsdl-clear-map").fadeIn()},this.gui.config.animate+200)},getValue:function(b){b=b.find(".jcsdl-input-geo").data("rect");if(!b.getMap())return"";b=this.exec("geo_box","getAllTipsFromBounds",[b.getBounds()]);return b.nw.lat()+","+b.nw.lng()+":"+b.se.lat()+","+b.se.lng()},displayValue:function(b,a){a=a.split(":");var c=a[0].split(","),d=a[1].split(",");return parseFloat(c[0]).format(2)+", "+parseFloat(c[1]).format(2)+" : "+parseFloat(d[0]).format(2)+", "+parseFloat(d[1]).format(2)},drawRectangle:function(b,
a,c){if(2!=c.length)return!1;c=this.exec("geo_box","getAllTipsFromUnspecified",[c[0],c[1]]);c=new google.maps.LatLngBounds(c.sw,c.ne);this.exec("geo_box","drawRectangleFromBounds",[b,a,c]);return!0},drawRectangleFromBounds:function(b,a,c){a.setBounds(c);a.setMap(b)},getAllTipsFromBounds:function(b){var a={};a.ne=b.getNorthEast();a.sw=b.getSouthWest();a.nw=new google.maps.LatLng(a.ne.lat(),a.sw.lng());a.se=new google.maps.LatLng(a.sw.lat(),a.ne.lng());return a},getAllTipsFromNWSE:function(b,a){var c=
{};c.nw=new google.maps.LatLng(parseFloat(b[0]),parseFloat(b[1]));c.se=new google.maps.LatLng(parseFloat(a[0]),parseFloat(a[1]));c.ne=new google.maps.LatLng(c.nw.lat(),c.se.lng());c.sw=new google.maps.LatLng(c.se.lat(),c.nw.lng());return c},getAllTipsFromUnspecified:function(b,a){var c={},d,e,f;this._geo.isNorth(b,a)?(c=b,d=a):(c=a,d=b);this._geo.isEast(b,a)?(f=b,e=a):(f=a,e=b);return c={nw:new google.maps.LatLng(c.lat(),e.lng()),ne:new google.maps.LatLng(c.lat(),f.lng()),se:new google.maps.LatLng(d.lat(),
f.lng()),sw:new google.maps.LatLng(d.lat(),e.lng())}},updateInfo:function(b,a){var c=this.exec("geo_box","getAllTipsFromBounds",[a.getBounds()]),d=google.maps.geometry.spherical.computeArea([c.nw,c.ne,c.se,c.sw]);b.find(".jcsdl-map-area span").html(Math.round(d/1E6).format()+" km<sup>2</sup>");j.each(c,function(a,c){b.find(".jcsdl-map-coordinates ."+a+" span").html(c.lat().format(2)+", "+c.lng().format(2))})}},geo_radius:{init:function(b){var a=this.getTemplate("valueInput_georadius");a.append(this.getTemplate("valueInput_geo_map"));
a.find(".jcsdl-map-coordinates").html(this.getTemplate("valueInput_georadius_coordinates"));a.find(".jcsdl-map-instructions").html(this.definition.inputs.geo_radius.instructions[0]);loadGoogleMapsApi(this.gui,this.exec,["geo_radius","load",[b,a]]);return a},load:function(b,a){var c=this,d=new google.maps.Map(a.find(".jcsdl-map-canvas")[0],jcsdlMapsOptions);a.data("map",d);var e=j.extend({},this.gui.config.mapsOverlay,{}),f=new google.maps.Circle(e);a.data("circle",f);var e={position:new google.maps.LatLng(0,
0),draggable:!0,icon:this.gui.config.mapsMarker},h=new google.maps.Marker(e);a.data("centerMarker",h);var g=new google.maps.Marker(e);a.data("radiusMarker",g);a.data("center",!1);this._geo.initSearch(a);google.maps.event.addListener(d,"click",function(b){if(a.data("center")){var e=google.maps.geometry.spherical.computeDistanceBetween(f.getCenter(),b.latLng);f.setRadius(e);f.setMap(d);g.setPosition(b.latLng);g.setMap(d);c.exec("geo_radius","updateInfo",[a,f]);a.find(".jcsdl-map-instructions").html(c.definition.inputs.geo_radius.instructions[2])}else f.setCenter(b.latLng),
h.setPosition(b.latLng),h.setMap(d),a.data("center",!0),a.find(".jcsdl-map-instructions").html(c.definition.inputs.geo_radius.instructions[1]);a.find(".jcsdl-clear-map").fadeIn()});google.maps.event.addListener(h,"position_changed",function(){var a=this.getPosition(),b=f.getCenter();f.setCenter(a);if(b!==m){var c=a.lat()-b.lat(),a=a.lng()-b.lng(),b=g.getPosition(),c=new google.maps.LatLng(b.lat()+c,b.lng()+a);g.setPosition(c)}});google.maps.event.addListener(g,"position_changed",function(){f.getCenter()!==
m&&(f.setRadius(google.maps.geometry.spherical.computeDistanceBetween(f.getCenter(),this.getPosition())),c.exec("geo_radius","updateInfo",[a,f]))});a.find(".jcsdl-clear-map").bind("click touchstart",function(b){b.preventDefault();b.target.blur();f.setCenter(null);f.setMap(null);h.setMap(null);g.setMap(null);a.data("center",!1);a.find(".jcsdl-map-area span").html("0 km<sup>2</sup>");a.find(".jcsdl-map-instructions").html(c.definition.inputs.geo_radius.instructions[0]);j(this).hide()})},setValue:function(b,
a,c){var d=this,e=b.find(".jcsdl-input-geo");c=c.split(":");var f=c[0].split(","),h=1E3*parseFloat(c[1]);setTimeout(function(){var a=e.data("map"),c=e.data("circle"),k=new google.maps.LatLng(f[0],f[1]),l=e.data("centerMarker");l.setPosition(k);l.setMap(a);var l=e.data("radiusMarker"),j=google.maps.geometry.spherical.computeOffset(k,h,90);l.setPosition(j);l.setMap(a);c.setCenter(k);c.setRadius(h);c.setMap(a);e.data("center",!0);a.fitBounds(c.getBounds());d.exec("geo_radius","updateInfo",[e,c]);b.find(".jcsdl-map-instructions").html(d.definition.inputs.geo_radius.instructions[2]);
b.find(".jcsdl-clear-map").fadeIn()},this.gui.config.animate+200)},getValue:function(b){b=b.find(".jcsdl-input-geo").data("circle");if(!b.getMap())return"";var a=b.getCenter();return a.lat()+","+a.lng()+":"+b.getRadius()/1E3},displayValue:function(b,a){a=a.split(":");var c=a[0].split(","),d=a[1];return"Center: "+parseFloat(c[0]).format(2)+", "+parseFloat(c[1]).format(2)+"; Radius: "+parseFloat(d).format(2)+" km"},updateInfo:function(b,a){var c=a.getRadius(),c=c*c*Math.PI;b.find(".jcsdl-map-area span").html(Math.round(c/
1E6).format()+" km<sup>2</sup>");c=a.getCenter();b.find(".jcsdl-map-coordinates .center span").html(c.lat().format(2)+", "+c.lng().format(2));b.find(".jcsdl-map-coordinates .radius span").html((a.getRadius()/1E3).format(2)+" km")}},geo_polygon:{init:function(b){var a=this.getTemplate("valueInput_geopolygon");a.append(this.getTemplate("valueInput_geo_map"));a.find(".jcsdl-map-coordinates").html(this.getTemplate("valueInput_geopolygon_coordinates"));a.find(".jcsdl-map-instructions").html(this.definition.inputs.geo_polygon.instructions[0]);
loadGoogleMapsApi(this.gui,this.exec,["geo_polygon","load",[b,a]]);return a},load:function(b,a){var c=this,d=new google.maps.Map(a.find(".jcsdl-map-canvas")[0],jcsdlMapsOptions);a.data("map",d);var e=j.extend({},this.gui.config.mapsOverlay,{paths:[[]],editable:!0}),f=new google.maps.Polygon(e),h=f.getPath();a.data("polygon",f);var g=new google.maps.MVCArray;a.data("markers",g);var m=1;this._geo.initSearch(a);google.maps.event.addListener(d,"click",function(a){h.push(a.latLng)});google.maps.event.addListener(h,
"insert_at",function(b){var e=new google.maps.Marker({map:d,position:h.getAt(b),draggable:!0,icon:c.gui.config.mapsMarker,zIndex:m++});g.insertAt(b,e);3<=h.getLength()&&f.setMap(d);b=3>=h.getLength()?h.getLength():3;a.find(".jcsdl-map-instructions").html(c.definition.inputs.geo_polygon.instructions[b]);c.exec("geo_polygon","updateInfo",[a,f]);a.find(".jcsdl-clear-map").fadeIn();google.maps.event.addListener(e,"position_changed",function(){var b=c.exec("geo_polygon","getMarkerIndex",[e,g]);-1!=b&&
(h.setAt(b,this.getPosition()),c.exec("geo_polygon","updateInfo",[a,f]))});google.maps.event.addListener(e,"dblclick",function(){var b=c.exec("geo_polygon","getMarkerIndex",[e,g]);-1!=b&&(h.removeAt(b),g.removeAt(b),this.setMap(null),c.exec("geo_polygon","updateInfo",[a,f]))})});google.maps.event.addListener(h,"set_at",function(a){var b=g.getAt(a);a=h.getAt(a);b.getPosition().equals(a)||b.setPosition(a)});a.find(".jcsdl-clear-map").bind("click touchstart",function(b){b.preventDefault();b.target.blur();
g.forEach(function(a){a.setMap(null)});g.clear();h.clear();c.exec("geo_polygon","updateInfo",[a,f]);a.find(".jcsdl-map-instructions").html(c.definition.inputs.geo_polygon.instructions[0]);j(this).hide()})},setValue:function(b,a,c){var d=this,e=b.find(".jcsdl-input-geo");c=c.split(":");setTimeout(function(){var a=e.data("polygon"),h=e.data("map");j.each(c,function(b,c){c=c.split(",");var d=new google.maps.LatLng(parseFloat(c[0]),parseFloat(c[1]));a.getPath().push(d)});h.fitBounds(a.getBounds());d.exec("geo_polygon",
"updateInfo",[e,a]);b.find(".jcsdl-map-instructions").html(d.definition.inputs.geo_polygon.instructions[3]);b.find(".jcsdl-clear-map").fadeIn()},this.gui.config.animate+200)},getValue:function(b){var a=[];b.find(".jcsdl-input-geo").data("polygon").getPath().forEach(function(b){a.push(b.lat()+","+b.lng())});return a.join(":")},displayValue:function(b,a){a=a.split(":");var c=[];j.each(a,function(a,b){b=b.split(",");c.push(parseFloat(b[0]).format(2)+", "+parseFloat(b[1]).format(2));if(1==a)return!1});
c=c.join(" : ");2<a.length&&(c+=" and "+(a.length-2)+" more...");return c},getMarkerIndex:function(b,a){var c=-1;a.forEach(function(a,e){a.getZIndex()==b.getZIndex()&&(c=e)});return c},updateInfo:function(b,a){var c=a.getPath(),d=b.find(".jcsdl-map-coordinates ul").html("");c.forEach(function(a){j("<li />").html("("+a.lat().format(4)+", "+a.lng().format(4)+")").appendTo(d)});3<=c.getLength()?(c=google.maps.geometry.spherical.computeArea(c),b.find(".jcsdl-map-area span").html(Math.round(c/1E6).format()+
" km<sup>2</sup>")):b.find(".jcsdl-map-area span").html("0 km<sup>2</sup>")}}}});;
;JCSDL.Loader.addComponent(function(b){var f=function(e,a){var d=this;this.select=a.select;this.$carousel=e.find(".jcsdl-carousel");this.$carouselWrap=this.$carousel.closest(".jcsdl-carousel-wrap");this.$carouselItems=this.$carousel.find(".jcsdl-carousel-item");this.$scrollLeft=this.$carouselWrap.siblings(".jcsdl-carousel-scroll.left");this.$scrollRight=this.$carouselWrap.siblings(".jcsdl-carousel-scroll.right");this.itemsCount=this.$carouselItems.filter(":visible").length;var c=this.$carouselItems.eq(0),
g=c.is(":visible")?!1:!0;c.show();this.itemWidth=c.outerWidth(!0);this.itemMargin=parseInt(c.css("marginRight"));this.$carouselWrap.css({maxWidth:this.calculateWrapWidth(),height:c.outerHeight(!0)});this.$carousel.css({position:"relative",width:this.itemWidth*this.itemsCount,height:c.outerHeight(!0)});this.margin=this.calculateCenterMargin();g&&c.hide();c=this.$carouselItems.filter(".selected");this.selectedIndex=1==c.length?c.prevAll(":visible").length:Math.floor(this.itemsCount/2);0==this.itemsCount%
2&&(this.selectedIndex-=0.5);this.changePosition(0,!a.expand);this.$carouselWrap.siblings(".jcsdl-carousel-scroll").bind("click touchstart",function(c){c.preventDefault();c.target.blur();c=b(this);c.hasClass("inactive")||(c=c.is(".left")?-1:1,0.5==d.selectedIndex-Math.floor(d.selectedIndex)&&(d.selectedIndex=0>c?d.selectedIndex:d.selectedIndex-1),d.selectedIndex=Math.round(d.selectedIndex)+c,d.changePosition(a.speed))});this.$carouselItems.bind("mousedown.jcsdlcarousel touchstart.jcsdlcarousel",function(c){c.preventDefault();
c.target.blur();var g=b(this),e=!1,f="touchmove"==c.type?c.originalEvent.targetTouches[0].pageX:c.pageX;b("body").bind("mousemove.jcsdlcarousel touchmove.jcsdlcarousel",function(a){e=!0;a="touchmove"==a.type?a.originalEvent.targetTouches[0].pageX:a.pageX;var b=parseInt(d.$carousel.css("left"));d.$carousel.css("left",b-(f-a));f=a});b("body").bind("mouseup.jcsdlcarousel touchend.jcsdlcarousel",function(){e?d.snapToSelection():(d.selectedIndex=g.prevAll(":visible").length,d.changePosition(a.speed),e=
!1);b("body").unbind("mousemove.jcsdlcarousel touchmove.jcsdlcarousel");b("body").unbind("mouseup.jcsdlcarousel touchend.jcsdlcarousel")})});this.$carouselItems.bind("jcsdlclick",function(){b(this).show();d.itemsCount=d.$carouselItems.filter(":visible").length;d.$carousel.css("width",d.itemWidth*d.itemsCount);b(this).trigger("mousedown").trigger("mouseup")});this.$carouselItems.click(function(c){c.preventDefault();c.target.blur();b.browser.msie&&(d.selectedIndex=b(this).prevAll(":visible").length,
d.changePosition(a.speed))});b(window).resize(function(){d.adjust()});this.$carouselItems.filter(":visible")};f.prototype={calculateWrapWidth:function(){return this.$carouselWrap.closest(".jcsdl-step").width()-this.$scrollLeft.outerWidth(!0)-this.$scrollRight.outerWidth(!0)},calculateCenterMargin:function(){return this.margin=(this.$carouselWrap.width()-this.itemWidth+this.itemMargin)/2},calculateCurrentPosition:function(){return-1*this.itemWidth*this.selectedIndex+this.margin},toggleScrollButtons:function(){this.$scrollLeft.removeClass("inactive");
this.$scrollRight.removeClass("inactive");0==this.selectedIndex&&this.$scrollLeft.addClass("inactive");this.selectedIndex+1>=this.itemsCount&&this.$scrollRight.addClass("inactive")},getSelectedItem:function(){return this.$carouselItems.filter(":visible").eq(this.selectedIndex)},snapToSelection:function(){var b=parseInt(this.$carousel.css("left"));this.selectedIndex=Math.round((b-this.margin)/(-1*this.itemWidth));this.selectedIndex=0>this.selectedIndex?0:this.selectedIndex;this.selectedIndex=this.selectedIndex+
1>this.itemsCount?this.itemsCount-1:this.selectedIndex;this.changePosition(100)},changePosition:function(b,a){var d=this;a=a||!1;this.$carousel.animate({left:this.calculateCurrentPosition()},b,function(){d.adjust()});this.toggleScrollButtons();!a&&("function"==typeof this.select&&0<this.itemsCount)&&this.select.apply(this.getSelectedItem())},adjust:function(){this.$carouselWrap.css({maxWidth:this.calculateWrapWidth()});this.calculateCenterMargin();this.$carousel.css({left:this.calculateCurrentPosition()})}};
b.fn.jcsdlCarousel=function(e){function a(a){var b=a.data("jcsdlCarousel");b||(b=new f(a,e),a.data("jcsdlCarousel",b));return b}if("string"==typeof e)return 0<=b.inArray(e,["adjust"])&&this.each(function(){var d=a(b(this));d[e].apply(d,[])}),this;e=b.extend({},{select:function(){},expand:!1,speed:200},e);this.each(function(){a(b(this))});return this}});
JCSDL.Loader.addComponent(function(b){b.fn.jcsdlNumberMask=function(f,e){this.each(function(){b(this).keydown(function(a){(190==a.which||110==a.which)&&(0<=b(this).val().indexOf(".")||!f)?a.preventDefault():a.shiftKey||a.altKey?a.preventDefault():46==a.which||(8==a.which||9==a.which||27==a.which||190==a.which||110==a.which||188==a.which&&e||65==a.which&&!0===a.ctrlKey||35<=a.which&&39>=a.which||13==a.which)||(48>a.which||57<a.which)&&(96>a.which||105<a.which)&&a.preventDefault()})});return this}});
JCSDL.Loader.addComponent(function(b,f){b.fn.jcsdlOrigVal=b.fn.val;b.fn.val=function(a){if(!this[0])return f;var d=b(this[0]);return d.data("jcsdlTagInput")&&a!==f?(d.jcsdlOrigVal(a),d.trigger("change"),d):a!==f?d.jcsdlOrigVal(a):d.jcsdlOrigVal()};var e=function(a,d){var c=this;this.delimeter=d.delimeter;this.numbers=d.numbers;this.floats=d.floats;this.$original=a;this.$original.data("jcsdlTagInputEnabled",!0);this.$wrap=b(this.tpl);this.$inputWrap=this.$wrap.find(".jcsdl-tag-field");this.$input=
this.$inputWrap.find("input");this.inputPh=this.$original.attr("placeholder");this.$input.attr("placeholder",this.inputPh);this.$original.hide().data("jcsdlTagValue",[]);this.$wrap.insertAfter(this.$original);this.$inputSizeHelper=b("<div />").addClass("jcsdl-tag-field-helper").css({position:"absolute",left:-9999,bottom:-9999,minWidth:100,width:"auto",textAlign:"left"}).appendTo(this.$inputWrap);this.numbers&&this.$input.jcsdlNumberMask(this.floats,!0);this.update();this.$wrap.bind("click touchstart",
function(){c.$input.focus()});this.$original.bind("change.jcsdltaginput",function(){!c.updating&&b(this).data("jcsdlTagInputEnabled")&&c.update()});this.$input.blur(function(){var a=c.$input.val();0!=a.length&&c.addTag(a)});this.$input.bind("paste.jcsdltaginput",function(){setTimeout(function(){var a=c.$input.val();0!=a.length&&c.addTag(a)},10)});this.$input.bind("keypress.jcsdltaginput",function(a){b(this).val();13==a.which?(a.preventDefault(),c.addTag(b(this).val())):c.reposition()});this.$input.bind("keydown.jcsdltaginput",
function(a){8==a.which&&0==b(this).val().length&&(a.preventDefault(),c.removeTag(c.$wrap.find(".jcsdl-tag:last")))});this.$input.bind("keyup.jcsdltaginput",function(){var a=b(this).val();a.charCodeAt(a.length-1)==c.delimeter.charCodeAt(0)&&"\\"!=a.charAt(a.length-2)&&c.addTag(a.substr(0,a.length-1))})};e.prototype={tpl:'<div class="jcsdl-tag-input"><div class="jcsdl-tag-field"><input type="text" /></div></div>',tagTpl:'<span class="jcsdl-tag"><span /><a href="#" class="jcsdl-tag-remove jcsdl-elements-sprite" title="Remove"></a></span>',
updating:!1,delimeter:",",numbers:!1,numbersArrVal:[],floats:!1,addTag:function(a){this.$input.val("");if(!(a===f||0==a.length)){var d=this,c=b(this.tagTpl);c.find("span").html(a.truncate());c.insertBefore(this.$inputWrap);var e=this.$original.data("jcsdlTagValue");e.push(a);this.$original.data("jcsdlTagValue",e);this.$original.val(e.join(this.delimeter));this.$input.attr("placeholder","");c.find("a").bind("click touchstart",function(a){a.preventDefault();a.target.blur();d.removeTag(c)});this.reposition()}},
removeTag:function(a){if(0!=a.length){var b=this.$wrap.find(".jcsdl-tag").index(a);a.remove();a=this.$original.data("jcsdlTagValue");a.splice(b,1);this.$original.data("jcsdlTagValue",a);this.$original.val(a.join(this.delimeter));0==a.length&&this.$input.attr("placeholder",this.inputPh);this.reposition()}},update:function(a){a=a?RegExp(/[\s,]+/g):this.delimeter;var d=this.$original.val();if(0!=d.length){var c=this;this.$original.data("jcsdlTagValue",[]);this.$wrap.find(".jcsdl-tag").remove();this.updating=
!0;var e=d.split(a),j=[];b.each(e,function(a,b){if(b===f)return!0;"\\"==b.charAt(b.length-1)&&(b+=c.delimeter+e[a+1],e.splice(a+1,1));j.push(b)});e=j;b.each(e,function(a,b){c.addTag(b)});this.updating=!1;this.reposition()}},reposition:function(){var a=this.$input.val().escapeHtml();0==a.length&&(a=this.$input.attr("placeholder"));this.$inputSizeHelper.html(a);this.$input.css({width:this.$inputSizeHelper.width()+32+"px",maxWidth:this.$wrap.width()-30,"font-size":this.$input.css("font-size"),"font-family":this.$input.css("font-family"),
"font-weight":this.$input.css("font-weight"),"letter-spacing":this.$input.css("letter-spacing"),whiteSpace:"nowrap"})},enable:function(){this.numbers&&(this.$original.data("jcsdlTagInputEnabled")?this.numbersArrVal=this.$original.val().split(this.delimeter):this.numbersArrVal[0]=this.$original.val());this.$original.data("jcsdlTagInputEnabled",!0);this.numbers&&this.$original.val(this.numbersArrVal.join(this.delimeter));this.$original.hide();this.$wrap.show()},disable:function(){if(this.numbers){var a=
"";this.$original.data("jcsdlTagInputEnabled")?(this.numbersArrVal=this.$original.val().split(this.delimeter),a=this.numbersArrVal[0]):a=this.$original.val()}this.$original.data("jcsdlTagInputEnabled",!1);this.numbers&&this.$original.val(a);this.$original.show();this.$wrap.hide()}};b.fn.jcsdlTagInput=function(a){function d(b){var c=b.data("jcsdlTagInput");c||(c=new e(b,a),b.data("jcsdlTagInput",c));return c}if("string"==typeof a){if(0<=b.inArray(a,["enable","disable","reposition","update","setDelimeter"])){var c=
[];b.each(arguments,function(a,b){if(0==a)return!0;c.push(b)});this.each(function(){var e=d(b(this));e[a].apply(e,c)})}return this}a=b.extend({},{delimeter:",",numbers:!1,floats:!1},a);this.each(function(){d(b(this))});return this}});
JCSDL.Loader.addComponent(function(b,f){var e=function(a,d){var c=this;this.$el=a;this.exp=RegExp();this.$btn=b('<a href="#" class="jcsdl-regex-tester-button jcsdl-elements-sprite">Test</a>').insertAfter(this.$el);this.$wrap=b('<div class="jcsdl-regex-tester"><p>If you want to test whether your regular expression correctly matches the desired strings, click the "Test" button and input example content in the shown field.</p></div>').insertAfter(this.$el).hide();this.$fields=b();this.$fieldsWraps=b();
for(var e=1;e<=d.fields;e++){var f=this.$el.clone().removeClass("orig").show().attr("placeholder","Test your expression against this field..."),h=b('<div class="jcsdl-regex-tester-input-wrap" />').html(f).append('<div class="jcsdl-regex-result jcsdl-elements-sprite" />');h.prependTo(this.$wrap);this.$fields=this.$fields.add(f);this.$fieldsWraps=this.$fieldsWraps.add(h)}this.$btn.bind("click touchstart",function(a){a.preventDefault();a.target.blur();c.$fieldsWraps.fadeIn();b(this).addClass("active")});
this.$el.bind("keyup change",function(){c.val=c.$el.val();c.test()});this.$fields.bind("keyup",function(){c.test(b(this))});this.disable()};e.prototype={mode:"partial",val:"",test:function(a){var e=this;a=a!==f?a:this.$fields;var c=this.val.replace(/\//g,"/");this.exp=RegExp("partial"==this.mode?""+c+"":"^"+c+"$","i");a.each(function(a,c){if(0==b(c).val().length||0==e.val.length)return b(c).siblings(".jcsdl-regex-result").hide(),!0;var f=e.exp.test(b(c).val())?"ok":"err";b(c).siblings(".jcsdl-regex-result").removeClass("ok err").addClass(f).fadeIn()})},
enable:function(){this.$el.data("jcsdlRegExTesterEnabled",!0);this.$el.addClass("jcsdl-regex-active");this.$wrap.fadeIn();this.$btn.fadeIn()},disable:function(){this.$el.data("jcsdlRegExTesterEnabled",!1);this.$el.removeClass("jcsdl-regex-active");this.$wrap.hide();this.$fieldsWraps.hide();this.$btn.hide()},setPartial:function(){this.mode="partial"},setExact:function(){this.mode="exact"}};b.fn.jcsdlRegExTester=function(a){function d(b){var d=b.data("jcsdlRegExTester");d||(d=new e(b,a),b.data("jcsdlRegExTester",
d));return d}if("string"==typeof a)return 0<=b.inArray(a,["enable","disable","setPartial","setExact","test"])&&this.each(function(){var c=d(b(this));c[a].apply(c,[])}),this;a=b.extend({},{fields:1},a);this.each(function(){d(b(this))});return this}});
JCSDL.Loader.addComponent(function(b){var f=function(e){var a=this;this.config=b.extend({},this.config,e);this.$overlay=b('<div class="jcsdl-overlay" />').appendTo("body").hide();this.$popup=b('<div class="jcsdl-popup"><div class="jcsdl-popup-header jcsdl-elements-sprite"><h4 /><a href="#" class="jcsdl-popup-close jcsdl-elements-sprite">Close</a></div><div class="jcsdl-popup-content" /></div>').appendTo("body").hide();this.config.title&&this.setTitle(this.config.title);this.config.content&&this.setContent(this.config.content);
this.$popup.css({minWidth:this.config.minWidth,maxWidth:this.config.maxWidth});this.setWidth(this.config.width);this.config.autoshow&&this.show();this.$popup.find(".jcsdl-popup-close").click(function(b){b.preventDefault();b.target.blur();b.stopPropagation();a.close()});b(window).resize(function(){a.$popup.is(":visible")&&a.reposition()})};f.prototype={$popup:b(),$overlay:b(),config:{width:700,minWidth:280,maxWidth:"70%",title:"",content:'<div class="jcsdl-popup-loading"></div>',autoshow:!0,overlay:!0},
getTitle:function(){return this.$popup.find(".jcsdl-popup-header h4").html()},setTitle:function(b){this.$popup.find(".jcsdl-popup-header h4").html(b);this.config.title=b},getContent:function(){return this.$popup.find(".jcsdl-popup-content")},setContent:function(e){var a=b(e),d=this.$popup.find(".jcsdl-popup-content");d.html("");a.each(function(a,e){d.append(b(e))});this.config.content=e},setWidth:function(b){this.$popup.width(b)},reposition:function(){this.$popup.css("position","absolute");this.$popup.find(".jcsdl-popup-content").css("maxHeight",
0.7*b(window).height());var e=(b(window).width()-this.$popup.outerWidth())/2+b(window).scrollLeft(),a=(b(window).height()-this.$popup.outerHeight())/2+b(window).scrollTop();0>a&&(a=0);0>e&&(e=0);this.$popup.css({left:e+"px",top:a+"px"})},show:function(){this.config.overlay&&this.$overlay.show();this.$popup.show();this.reposition()},hide:function(){this.$overlay.hide();this.$popup.hide()},close:function(){this.$overlay.remove();this.$popup.remove()}};b.jcsdlPopup=function(b){return new f(b)}});
JCSDL.Loader.addComponent(function(b,f){b.fn.animateIntoView=function(e,a,d){e=e===f?200:e;a=parseInt(a)||0;d="function"==typeof d?d:function(){};var c=b(this[0]);if(!c.length)return this;var g=b("body"),j=b("html"),c=c.offset().top,h=parseInt(g.scrollTop()),k=h+b(window).height();if(h<c&&c<k)return this;g.add(j).animate({scrollTop:c-a},e,d);return this}});
var jcsdlMapsLoaded=!1,jcsdlMapsCurrentGui=null,jcsdlMapsCurrentCallback=function(){},jcsdlMapsCurrentCallbackArgs=[],jcsdlMapsOptions={},loadGoogleMapsApi=function(b,f,e){jcsdlMapsCurrentGui=b;jcsdlMapsCurrentCallback=f;jcsdlMapsCurrentCallbackArgs=e;jcsdlMapsLoaded?jcsdlMapsInit():(b=0<jcsdlMapsCurrentGui.config.googleMapsApiKey.length?"key="+jcsdlMapsCurrentGui.config.googleMapsApiKey+"&":"",f="file:"==window.location.protocol?"http:":"",jQuery("body").append('<script type="text/javascript" src="'+
f+"//maps.googleapis.com/maps/api/js?"+b+'libraries=places,geometry&sensor=false&callback=jcsdlMapsInit" />'),jcsdlMapsLoaded=!0)},jcsdlMapsInit=function(){jcsdlMapsOptions={center:new google.maps.LatLng(40,0),zoom:1,mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU},navigationControl:!0,navigationControlOptions:{style:google.maps.NavigationControlStyle.SMALL}};google.maps.Polygon.prototype.getBounds||(google.maps.Polygon.prototype.getBounds=
function(){for(var b=new google.maps.LatLngBounds,f=this.getPaths(),e,a=0;a<f.getLength();a++){e=f.getAt(a);for(var d=0;d<e.getLength();d++)b.extend(e.getAt(d))}return b});jcsdlMapsCurrentGui&&jcsdlMapsCurrentCallback&&setTimeout(function(){jcsdlMapsCurrentCallback.apply(jcsdlMapsCurrentGui.inputs,jcsdlMapsCurrentCallbackArgs)},jcsdlMapsCurrentGui.config.animate+10)};
JCSDL.Loader.addComponent(function(b,f){b.extend(String.prototype,{truncate:function(b,a,d){b=b||72;a=a||"...";if(this.length<=b)return this.valueOf();s=this.substr(0,b);d||(s=s.substr(0,s.lastIndexOf(" ")));return s+a},isNumeric:function(){return!isNaN(parseInt(this.valueOf()))},escapeHtml:function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},unescapeHtml:function(){return this.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,
'"')},escapeCsdl:function(){return this.replace(/\\(?![,:]+)/g,"\\\\").replace(/"/g,'\\"')},unescapeCsdl:function(){return this.replace(/\\"/g,'"').replace(/\\\\/g,"\\")}});b.extend(Number.prototype,{format:function(b,a,d){var c=this.toString().replace(/[^0-9+\-Ee.]/g,""),c=!isFinite(+c)?0:+c;b=!isFinite(+b)?0:Math.abs(b);d=d===f?",":d;a=a===f?".":a;var g="",g=function(a,b){var c=Math.pow(10,b);return""+Math.round(a*c)/c},g=(b?g(c,b):""+Math.round(c)).split(".");3<g[0].length&&(g[0]=g[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,
d));if((g[1]||"").length<b)g[1]=g[1]||"",g[1]+=Array(b-g[1].length+1).join("0");return g.join(a)}})});;
;JCSDL.Loader.addComponent(function(f,j){this.GUIFilterEditor=function(a,b,c){b=b||f();c=c||{};var d=this;this.gui=a;this.config=a.config;this.definition=a.definition;this.parser=a.parser;this.inputs=a.inputs;this.getTemplate=a.getTemplate;this.getIconForField=a.getIconForField;this.filter=c;this.steps=[];this.target=null;this.path=[];this.$view=this.getTemplate("filterEditor");this.$steps=this.$view.find(".jcsdl-steps");this.$view.appendTo(b).show();this.addFilterStep("target",this.createTargetSelectView());
this.$view.find(".jcsdl-filter-save").hide();this.$view.find(".jcsdl-footer span").hide();this.$view.find(".jcsdl-filter-save").bind("click touchstart",function(a){a.preventDefault();a.target.blur();d.didSubmitFilter()});this.$view.find(".jcsdl-filter-cancel").bind("click touchstart",function(a){a.preventDefault();a.target.blur();d.gui.hideFilterEditor();d.trigger("filterCancel")});this.loadFilter(c)};this.GUIFilterEditor.prototype={filter:{},jsonpCache:{operators:{},targets:{}},adjust:function(){this.$steps.find(".jcsdl-step").jcsdlCarousel("adjust")},
loadFilter:function(a){var b=this;this.filter=a;if(a===j||!a||a.target===j)return!1;var c=this.parser.getFieldInfo(a.target,a.fieldPath);this.$view.find(".jcsdl-filter-target .target-"+a.target).trigger("jcsdlclick");f.each(a.fieldPath,function(a,c){b.$view.find(".jcsdl-filter-target-field:last").find(".field-"+c).trigger("jcsdlclick")});"string"!==typeof c.input&&this.$view.find(".jcsdl-filter-target-field-input .input-"+a.operator).trigger("jcsdlclick");"text"==c.input?f(".jcsdl-dropdown .jcsdl-dropdown-option.operator-"+
a.operator).click():this.$view.find(".jcsdl-filter-value-input-operators .operator-"+a.operator).click();var d=this.$view.find(".jcsdl-filter-value-input-field");this.setValueForField(d,c,a.value,a.operator);a.cs&&this.$view.find(".jcsdl-operator-cs").click()},addFilterStep:function(a,b,c){var d=this;c=c===j?!0:c;var e=this.getTemplate("step"),h=this.steps.length;e.html(b).data("number",h).addClass("jcsdl-filter-step-number-"+h).data("name",a).addClass("jcsdl-filter-step-"+a).appendTo(this.$steps);
"target"==a&&e.jcsdlCarousel({select:function(){var a=f(this);e.addClass("selected").find(".jcsdl-carousel-item.selected").removeClass("selected");a.addClass("selected");d.didSelectTarget(a.data("name"))}});"field"==a&&e.jcsdlCarousel({select:function(){var a=f(this);d.$steps.find(".jcsdl-filter-step-target").addClass("field-selected");var c=e.data("number")-1;d.$steps.find(".jcsdl-filter-step-field.jcsdl-filter-step-number-"+c).addClass("field-selected");e.addClass("selected").find(".jcsdl-carousel-item.selected").removeClass("selected");
a.addClass("selected");d.didSelectField(a.data("name"),b,e)}});"input"==a&&e.jcsdlCarousel({select:function(){var a=f(this),c=e.data("number")-1;d.$steps.find(".jcsdl-filter-step-field.jcsdl-filter-step-number-"+c).addClass("field-selected");e.addClass("selected").find(".jcsdl-carousel-item.selected").removeClass("selected");a.addClass("selected");d.didSelectInput(a.data("name"),b,e)}});"value"==a&&(this.$view.find(".jcsdl-filter-save").fadeIn(this.config.animate),this.$view.find(".jcsdl-footer span").show());
c?e.hide().slideDown(this.config.animate):"field"==a?e.find(".jcsdl-filter-target-field").hide().fadeIn(this.config.animate):e.hide().fadeIn(this.config.animate);setTimeout(function(){d.adjust()},this.config.animate);this.steps.push(e)},removeFilterStepsAfterPosition:function(a){this.$steps.find(".jcsdl-step").eq(a).removeClass("field-selected");a=this.steps.splice(a+1,this.steps.length-a);var b="";this.$view.find(".jcsdl-filter-save").hide();this.$view.find(".jcsdl-footer span").hide();f.each(a,
function(a,d){var e=f(d);0==a&&(b=e.data("name"));e.remove()});return b},didSelectTarget:function(a){if(this.definition.targets[a]===j)return!1;this.target=a;this.path=[];var b=this.removeFilterStepsAfterPosition(0),c=this.createFieldSelectionView(this.definition.targets[a].fields);this.addFilterStep("field",c,"field"!=b);this.trigger("targetSelect",[a])},didSelectField:function(a,b,c){var d=b.data("position");this.path.splice(d,this.path.length-d);c.removeClass("selected-final").find(".jcsdl-target-help").remove();
var e=this.getFieldInfoAtCurrentPath(a);!1!=e&&(d=this.removeFilterStepsAfterPosition(b.closest(".jcsdl-step").data("number")),this.path.push(a),e.fields!==j?(b=this.createFieldSelectionView(e.fields),this.addFilterStep("field",b,"field"!=d)):"string"!==typeof e.input?(c=this.createInputSelectionView(e.input),this.addFilterStep("input",c,"input"!=d)):(a=this.createValueInputView(e),this.addFilterStep("value",a,"value"!=d),this.addTargetHelpToStep(c),this.trigger("targetSelect",[this.getCurrentPath()])))},
didSelectInput:function(a,b,c){b.data("position");b=this.removeFilterStepsAfterPosition(b.closest(".jcsdl-step").data("number"));c.removeClass("selected-final").find(".jcsdl-target-help").remove();a=this.createValueInputView(this.getFieldInfoAtCurrentPath(),a);this.addFilterStep("value",a,"value"!=b);this.addTargetHelpToStep(c)},addTargetHelpToStep:function(a){var b=this;this.getTemplate("targetHelp").appendTo(a);a.find(".jcsdl-target-help").click(function(a){a.preventDefault();a.target.blur();a=
b.getFieldInfoAtCurrentPath();var d=b.target,e=b.parser.getTargetInfo(d);path=b.path.join("-");title=e.name;cPath=[];f.each(b.path,function(a,c){cPath.push(c);title+=" &raquo; "+b.parser.getFieldInfo(d,cPath).name});var h=path;"augmentation"!=d&&(h=d+"."+h);a=b.config.targetHelpUrl.apply(b,[h.replace(/-/g,"."),a]);var g=f.jcsdlPopup({title:title});b.jsonpCache.targets[h]===j?f.ajax({url:a,type:"GET",async:!1,jsonpCallback:"jcsdlJSONP",contentType:"application/json",dataType:"jsonp",success:function(a){!a||
!a.html||!f.trim(a.html)?(g.setContent("<p>No documentation available.</p>"),g.reposition()):(g.setContent(a.html),g.reposition(),b.jsonpCache.targets[h]=a.html)},error:function(){g.setContent("<p>No documentation available.</p>");g.reposition()}}):(g.setContent(b.jsonpCache.targets[h]),g.reposition())})},didSubmitFilter:function(){var a=this.getFilterInfo();a&&this.gui.didSubmitFilter(a)},showError:function(a,b){this.$view.find(".jcsdl-error").remove();var c=this.getTemplate("error");c.find("span").html(a);
c.prependTo(this.$view.find(".jcsdl-footer")).hide().fadeIn();console!==j&&console.error(a,arguments)},trigger:function(a,b){this.gui.trigger(a,b)},createTargetSelectView:function(){var a=this,b=this.getTemplate("target"),c=b.find(".jcsdl-filter-target");f.each(this.definition.targets,function(b,e){a.createOptionForTarget(b,e).appendTo(c)});return b},createOptionForTarget:function(a,b){var c=this.getTemplate("targetOption").data("name",a).data("target",b).addClass("target-"+a);0<=f.inArray(a,this.config.hideTargets)&&
(c.addClass("jcsdl-option-hidden"),(this.filter.target===j||this.filter.target!==a)&&c.hide());return c},createFieldSelectionView:function(a){var b=this,c=this.path.length,d=this.target+(0<this.path.length?"."+this.path.join("."):""),e=this.getTemplate("field"),h=!1,g=f.merge([this.target],this.path),k="";e.data("position",c).addClass("field-select-"+c);f.each(g,function(a,c){k=k+(0<a?".":"")+c;if(0<=f.inArray(k,b.config.hideTargets))return h=!0});var j=e.find(".jcsdl-filter-target-field");f.each(a,
function(a,c){b.createOptionForField(a,c,d,h).appendTo(j)});return e},createOptionForField:function(a,b,c,d){var e=this;b=this.getTemplate("fieldOption").data("name",a).data("field",b).html(b.name).addClass("icon-"+this.getIconForField(a,b)).addClass("field-"+a);if(!d){var h=c+"."+a;if(0<=f.inArray(h,e.config.hideTargets))d=!0;else{var h=h.split("-"),g="";f.each(h,function(a,b){g+=(0<a?".":"")+b;if(0<=f.inArray(g,e.config.hideTargets))return d=!0})}}d&&b.addClass("jcsdl-option-hidden");d&&this.filter&&
this.filter.target!==j&&this.filter.fieldPath!==j&&this.filter.target+"."+this.filter.fieldPath.join(".").replace(/-/g,".")==c+"."+a&&(d=!1);d&&b.hide();return b},createInputSelectionView:function(a){var b=this,c=this.getTemplate("inputSelect"),d=c.find(".jcsdl-filter-target-field-input");f.each(a,function(a,c){b.createOptionForInput(c).appendTo(d)});return c},createOptionForInput:function(a){return this.getTemplate("inputSelectOption").data("name",a).addClass("icon-"+a+" input-"+a).html(a)},createValueInputView:function(a,
b){b=b||a.input;var c=this.getTemplate("valueInput");if(this.inputs[b]===j)return c;var d=this.inputs.exec(b,"init",[a]);d.find("input:first");var d=c.find(".jcsdl-filter-value-input-field").data("inputType",b).html(d),e=c.find(".jcsdl-filter-value-input-operators");"text"==b?this.createTextOperatorsSelectView(e,a,b,d):this.createOperatorsSelectView(e,a,b,d);return c},createOperatorsSelectView:function(a,b,c,d){var e=this,h=d.find("input:first"),g=this.definition.inputs[c]!==j?this.definition.inputs[c]:
{},k=g.operators!==j?g.operators:[];f.each(b.operators,function(b,c){if(0<k.length&&-1==f.inArray(c,k))return!0;var d=e.createOperatorOptionView(c);f.browser.msie&&d.html("&nbsp;");a.append(d)});a.children().bind("click touchstart",function(b){b.preventDefault();b.target.blur();var j=f(this);b=j.data("name");a.children().removeClass("selected");j.addClass("selected");"exists"==b?d.fadeOut(e.config.animate):d.is(":visible")||d.fadeIn(e.config.animate);"number"==c&&(j=0<=f.inArray(b,g.arrayOperators)?
"enable":"disable",h.jcsdlTagInput(j));e.trigger("operatorSelect",[b])});1==a.children().length?(a.children().eq(0).click(),a.children().hide()):(b=a.find(".operator-"+(b.operator!==j?b.operator:g.operator)),0<b.length?b.click():a.find(".operator:not(.operator-exists):first").click());return a},createTextOperatorsSelectView:function(a,b,c,d){var e=this;f(".jcsdl-dropdown").remove();a.addClass("text");var h=d.find("input.orig"),g=this.getTemplate("textOperatorsSelect"),k=this.getTemplate("textOperatorsDropdown"),
l=this.definition.inputs[c]!==j?this.definition.inputs[c]:{},n=l.operators!==j?l.operators:[];f.each(b.operators,function(a,b){if(0<n.length&&-1==f.inArray(b,n))return!0;var c=e.createTextOperatorOptionView(b);k.append(c)});a.html(g).insertAfter(d);k.hide().appendTo("body");if(b.cs){var m=this.getTemplate("caseSensitivity");m.bind("click touchstart",function(a){a.preventDefault();a.target.blur();f(this).toggleClass("selected");e.trigger("caseSensitivityChange",[f(this).is(".selected")])}).tipsy({gravity:"s",
offset:9});m.prependTo(a);g.addClass("has-cs")}g.click(function(a){a.preventDefault();a.target.blur();a.stopPropagation();g.hasClass("active")?(k.slideUp(e.config.animate),g.removeClass("active")):(k.css({top:g.offset().top+g.outerHeight()-1,left:g.offset().left,width:g.outerWidth()-2}).slideDown(e.config.animate),g.addClass("active"),f("body").bind("click.jcsdldropdown",function(a){a=f(a.target).closest(".jcsdl-dropdown");if(null==a||!a.is(".jcsdl-dropdown"))g.removeClass("active"),k.slideUp(e.config.animate),
f("body").unbind("click.jcsdldropdown")}))});k.find(".jcsdl-dropdown-details-trigger, .jcsdl-operator-help").click(function(a){a.preventDefault();a.target.blur();a.stopPropagation();a=f(this).closest(".jcsdl-dropdown-option");var b=a.data("name"),c=f.jcsdlPopup({title:a.data("title")});e.jsonpCache.operators[b]===j?f.ajax({url:a.data("jsonp"),type:"GET",async:!1,jsonpCallback:"jcsdlJSONP",contentType:"application/json",dataType:"jsonp",success:function(a){!a||!a.html||!f.trim(a.html)?(c.setContent("<p>No documentation available.</p>"),
c.reposition()):(c.setContent(a.html),c.reposition(),e.jsonpCache.operators[b]=a.html)}}):(c.setContent(e.jsonpCache.operators[b]),c.reposition())});k.find(".jcsdl-dropdown-option").click(function(a){a.preventDefault();a.target.blur();g.removeClass("active");k.hide();a=f(this).data("name");var c=e.definition.operators[a];g.data("operator",a).find(".jcsdl-operator-label").html(c.label);"exists"==a?(d.fadeOut(e.config.animate),b.cs&&m.fadeOut(e.config.animate)):d.is(":visible")||(d.fadeIn(e.config.animate),
b.cs&&m.fadeIn(e.config.animate));"contains_near"==a?(d.find(".jcsdl-containsnear-distance").fadeIn(),d.find(".jcsdl-tag-field input").bind("keydown.nospace",function(a){32==a.which&&a.preventDefault()}),h.jcsdlTagInput("update",!0),h.data("split",!0)):(d.find(".jcsdl-containsnear-distance").hide(),d.find(".jcsdl-tag-field input").unbind("keydown.nospace"),h.data("split")&&(h.jcsdlTagInput("update"),h.data("split",!1)));c=0<=f.inArray(a,l.arrayOperators)?"enable":"disable";h.jcsdlTagInput(c);"enable"==
c&&h.jcsdlTagInput("update");c=0<=f.inArray(a,["regex_partial","regex_exact"])?"enable":"disable";h.jcsdlRegExTester(c);"enable"==c&&(h.jcsdlRegExTester("set"+("regex_partial"==a?"Partial":"Exact")),h.jcsdlRegExTester("test"));e.trigger("operatorSelect",[a])});f(window).resize(function(){g.hasClass("active")&&k.css({top:g.offset().top+g.outerHeight()-1,left:g.offset().left,width:g.outerWidth()-2})});1==k.find(".jcsdl-dropdown-option").length?k.find(".jcsdl-dropdown-option:first").click():(c=k.find(".jcsdl-dropdown-option.operator-"+
(b.operator!==j?b.operator:l.operator)),0<c.length?c.click():k.find(".jcsdl-dropdown-option:not(.operator-exists):first").click());return a},createOperatorOptionView:function(a){var b=this.definition.operators[a];return b===j?f():this.getTemplate("operatorOption").data("name",a).addClass("icon-"+a+" operator-"+a).attr("title",b.description).html(b.label).tipsy({gravity:"s",offset:9})},createTextOperatorOptionView:function(a){var b=this.definition.operators[a];if(b===j)return f();var c=this.getTemplate("textOperatorOption").data("name",
a).data("title",b.label).addClass("operator-"+a);c.find(".jcsdl-icon").addClass("icon-"+a+" operator-"+a+" selected");c.find(".jcsdl-operator-label span").html(b.label);c.find(".jcsdl-operator-desc").html(b.description);b.jsonp?c.data("jsonp",b.jsonp):(c.find(".jcsdl-dropdown-details-trigger").remove(),c.find(".jcsdl-operator-help").remove());return c},setValueForField:function(a,b,c,d){var e=this,h=a.data("inputType");if(this.inputs[h]===j)return!1;if(0<=f.inArray(h,["geo_box","geo_radius","geo_polygon"])){var g=
jcsdlMapsCurrentGui,k=jcsdlMapsCurrentCallback,l=jcsdlMapsCurrentCallbackArgs;jcsdlMapsCurrentCallback=function(){g&&k&&setTimeout(function(){k.apply(g.inputs,l);e.inputs.exec(h,"setValue",[a,b,c,d])},g.config.animate+10)}}else this.inputs.exec(h,"setValue",[a,b,c,d]);return!0},getValueFromField:function(a,b,c){var d=a.data("inputType");return this.inputs[d]===j?"":this.inputs.exec(d,"getValue",[a,b,c])},getView:function(){return this.$view},getFilterInfo:function(){var a=this.getFieldInfoAtCurrentPath(),
b="text"==a.input?this.$view.find(".jcsdl-filter-value-input-operators .jcsdl-operators-select").data("operator"):this.$view.find(".jcsdl-filter-value-input-operators .operator.selected").data("name");if(b===j)this.showError("You need to select an operator!");else{var c="";if("exists"!==b&&(c=this.$view.find(".jcsdl-filter-value-input-field"),c=this.getValueFromField(c,a,b),0==c.length)){this.showError("You need to specify a value!");return}return{target:this.target,path:this.path,operator:b,value:c,
additional:{cs:"exists"!==b&&a.cs&&0<this.$view.find(".jcsdl-operator-cs.selected").length?!0:!1}}}},getFieldInfoAtCurrentPath:function(a){var b=this.path.slice(0);"string"==typeof a&&b.push(a);return this.parser.getFieldInfo(this.target,b)},getCurrentPath:function(){return this.target+(0<this.path.length?".":"")+this.path.join(".").replace(/-/g,".")}}});;
;JCSDL.Loader.addComponent(function(e,h){this.GUILogic=function(a,b){var c=this;this.gui=a;this.config=a.config;this.parser=a.parser;this.getTemplate=a.getTemplate;this.$logicOptions=a.$mainView.find(".jcsdl-filters-logic .jcsdl-filters-logic-option:not(.jcsdl-advanced-option)");this.$advancedOptions=a.$mainView.find(".jcsdl-filters-logic .jcsdl-filters-logic-option.jcsdl-advanced-option");this.$insertBracketsButton=this.$advancedOptions.filter(".jcsdl-advanced-add-brackets");this.$editor=a.$mainView.find(".jcsdl-advanced-container");
this.$guiContainer=this.initGui(this.$editor.find(".jcsdl-advanced-gui-container"));this.$gui=this.$guiContainer.find(".jcsdl-advanced-gui");this.$manual=this.$editor.find(".jcsdl-advanced-manual");this.$manualInput=this.initManualInput(this.$manual.find("input"));this.$logicOptions.click(function(a){a.preventDefault();a.target.blur();a=e(this);if(a.is(".disabled")||a.is(".active"))return!1;var b=c.logic;c.logic=a.data("logic");c.didSetLogic(b,!1)});this.$logicOptions.filter(".jcsdl-advanced").find(".jcsdl-logic-help").tipsy({gravity:"s",
trigger:"manual",title:function(){return c.$editor.is(":visible")?e(this).data(c.$manual.is(":visible")?"textManual":"textGui"):e(this).data("textGeneral")}}).click(function(a){a.preventDefault();a.target.blur();a.stopPropagation();var b=e(this);b.tipsy("show");e("body").one("click",function(){b.tipsy("hide")})});this.$advancedOptions.filter(".jcsdl-advanced-manual-edit").click(function(a){a.preventDefault();a.target.blur();a=e(this);if(a.is(".on")){try{c.validate(c.getManualString())}catch(b){c.showError(b);
return}a.removeClass("on");a.html(a.data("textGui"));c.$manualInput.blur();c.$manual.hide();c.$guiContainer.fadeIn(c.config.animate);c.$insertBracketsButton.removeClass("disabled");c.setGuiString();c.trigger("graphicalLogic")}else{try{c.validate(c.getGuiString())}catch(d){c.showError(d);return}a.addClass("on");a.html(a.data("textManual"));c.setManualString();c.$guiContainer.hide();c.$manual.fadeIn(c.config.animate);c.$manualInput.focus();c.$insertBracketsButton.addClass("disabled");c.trigger("manualLogic")}});
try{this.setLogic(b,!0)}catch(d){this.showError(d,!0)}};this.GUILogic.prototype={ADVANCED:"ADVANCED",AND:"AND",OR:"OR",tokenize:function(a){a=a||this.logicString;return this.parser.tokenizeLogicString(a)},validate:function(a,b){a=a||this.logicString;b=b||this.gui.filters;return this.parser.validateLogic(a,b)},showEditor:function(){this.$editor.show();this.adjustGui();this.$editor.hide().slideDown(this.config.animate);this.gui.$mainView.addClass("jcsdl-advanced-on")},hideEditor:function(){this.$editor.slideUp(this.config.animate);
this.gui.$mainView.removeClass("jcsdl-advanced-on")},toggleButtons:function(a){(a=a===h?!0:a)||this.setLogic(this.AND);this.$logicOptions[a?"removeClass":"addClass"]("disabled")},showError:function(a,b){b=b||!1;this.clearErrors();var c=a instanceof JCSDL.LogicValidationException?a.message:a,d=this.getTemplate("error");d.find("span").html(c);d.insertAfter(this.$editor).show();b||this.trigger("logicError",[a]);b||(this.trigger("logicError",[a]),console!==h&&console.error(a,arguments));a instanceof JCSDL.LogicValidationException&&
this.$gui.is(":visible")&&0<=a.index&&(c=this.$gui.children().not(".jcsdl-token-ph").eq(a.index).find(".jcsdl-logic-token").addClass("error"),this.scrollGuiToToken(c));d.animateIntoView(this.config.animate)},trigger:function(a,b){this.gui.trigger(a,b)},clearErrors:function(){this.gui.clearErrors();this.$gui.find(".error").removeClass("error")},initGui:function(a){var b=this,c=a.find(".jcsdl-advanced-gui"),d=null;this.$guiLeft=a.find(".jcsdl-advanced-gui-arrow.left");this.$guiRight=a.find(".jcsdl-advanced-gui-arrow.right");
c.sortable({cursor:"move",placeholder:"jcsdl-token-ph",containment:a,appendTo:a,helper:"clone",tolerance:"intersect",start:function(a,b){b.item.find(".jcsdl-logic-token").is(".bracket")&&c.find(".jcsdl-token-ph").addClass("bracket")},stop:function(a,c){var d=c.item.find(".jcsdl-logic-token");d.is(".filter")&&b.gui.highlightFilter(d.data("token"),!1)},sort:function(a,c){clearInterval(d);b.$guiRight.is(":visible")&&c.offset.left+c.helper.width()/2>=b.$guiRight.offset().left&&(d=setInterval(function(){b.scrollGui("right",
50)},50));b.$guiLeft.is(":visible")&&c.offset.left<=b.$guiLeft.offset().left+c.helper.width()/2&&(d=setInterval(function(){b.scrollGui("left",50)},50));var e=c.helper.find(".jcsdl-logic-token");e.is(".filter")&&b.gui.highlightFilter(e.html())},update:function(){clearInterval(d);setTimeout(function(){b.updateFromGui();var a=b.getGuiString();b.trigger("graphicalLogicTokenMove",[a]);b.trigger("graphicalLogicChange",[a]);b.trigger("advancedLogicChange",[a])},100)}});(c.data("sortable")||{}).floating=
!0;(c.data("uiSortable")||{}).floating=!0;this.$insertBracketsButton.click(function(a){a.preventDefault();a.target.blur();if(e(this).is(".disabled"))return!1;b.addGuiToken(")",!0,!0);b.updateFromGui();a=b.getGuiString();b.trigger("parenthesisAdd",[a]);b.trigger("graphicalLogicChange",[a]);b.trigger("advancedLogicChange",[a])});this.$guiRight.add(this.$guiLeft).bind("mousedown touchstart",function(){var a=e(this).is(".right")?"right":"left";d=setInterval(function(){b.scrollGui(a,50)},50)}).bind("mouseup mouseleave touchend",
function(){clearInterval(d)}).click(function(a){a.preventDefault();a.target.blur()});e(window).resize(function(){b.adjustGui()});return a},updateFromGui:function(){var a=this.getGuiTokens();try{this.validate(a)&&(this.clearErrors(),this.logicString=a.join(""))}catch(b){this.showError(b,!0)}},setGuiString:function(a){a=a||this.logicString;var b=this;a="string"===typeof a||"number"===typeof a?this.tokenize(a):a;this.clearGui();e.each(a,function(a,d){b.addGuiToken(d,!1)})},getGuiString:function(a){a=
a||this.$gui;var b="";a.find(".jcsdl-logic-token").each(function(){b+=""+e(this).data("token")});return b},getGuiTokens:function(a){a=a||this.$gui;var b=[];a.find(".jcsdl-logic-token").each(function(){b.push(e(this).data("token"))});return b},clearGui:function(){this.$gui.width(0).children().remove()},tokensMap:{"(":"bracketOpen",")":"bracketClose","&":"operatorAnd","|":"operatorOr",filter:"filter"},addGuiToken:function(a,b,c){b=b===h?!0:b;c=c===h?!1:c;var d=this,f="number"==typeof a?"filter":a;if(this.tokensMap[f]===
h)throw'Invalid character "'+a+'" in the logic!';var g=this.getTemplate("logicToken_"+this.tokensMap[f]).data("token",a),j=e();"filter"==f&&g.html(a);f=e('<li class="jcsdl-logic-token-wrap" />').html(g).appendTo(this.$gui);this.$gui.width(this.$gui.width()+f.outerWidth(!0));if(")"==a&&c){j=this.getTemplate("logicToken_bracketOpen").data("token","(");a=this.getGuiTokens().reverse();var k=a.length,l=-1,m=null;e.each(a,function(a,b){")"==b?l++:"("==b&&l--;if(0==l&&0<=e.inArray(b,["&","|"])){if(null!==
m&&b!==m)return k=a,!1;m=b}});a=this.$gui.children().eq(a.length-k);a=e('<li class="jcsdl-logic-token-wrap" />').html(j).insertBefore(a);this.$gui.width(this.$gui.width()+a.outerWidth(!0))}this.updateFromGui();this.adjustGui();b&&this.scrollGuiToToken(g);g.click(function(a){a.preventDefault();a.target.blur();"&"==g.data("token")?(g.data("token","|").html("OR"),d.trigger("logicOperatorSwitch",["OR"]),a=d.getGuiString(),d.trigger("graphicalLogicChange",[a]),d.trigger("advancedLogicChange",[a])):"|"==
g.data("token")&&(g.data("token","&").html("AND"),d.trigger("logicOperatorSwitch",["AND"]),a=d.getGuiString(),d.trigger("graphicalLogicChange",[a]),d.trigger("advancedLogicChange",[a]));d.updateFromGui()});g.add(j).find(".jcsdl-delete-token").click(function(a){a.preventDefault();a.target.blur();a.stopPropagation(!0);d.deleteGuiToken(g);a=d.getGuiString();d.trigger("parenthesisDelete",[a]);d.trigger("graphicalLogicChange",[a]);d.trigger("advancedLogicChange",[a])});g.filter(".filter").hover(function(){d.gui.highlightFilter(e(this).data("token"))},
function(){d.gui.highlightFilter(e(this).data("token"),!1)})},deleteGuiFilterToken:function(a){a=parseInt(a);var b=e(),c=e();this.$gui.children().each(function(){var c=e(this);if(parseInt(c.find(".jcsdl-logic-token").data("token"))===a)return b=c,!1});if(!b.length)return!1;for(;"("==b.prev().find(".jcsdl-logic-token").data("token")&&")"==b.next().find(".jcsdl-logic-token").data("token");)b.prev().remove(),b.next().remove();b.prev().find(".jcsdl-logic-token.operator").length?c=b.prev():b.next().find(".jcsdl-logic-token.operator").length&&
(c=b.next());b.remove();c.remove();this.updateFromGui();c=self.getGuiString();self.trigger("graphicalLogicChange",[c]);self.trigger("advancedLogicChange",[c])},deleteGuiToken:function(a){var b=a.is(".jcsdl-logic-token")?a.closest("li.jcsdl-logic-token-wrap"):a;if(!b.is("li.jcsdl-logic-token-wrap"))return!1;a=b.find(".jcsdl-logic-token");if(a.is(".operator"))return!1;if(a.is(".filter")){var c=a.data("token"),d=!1;e.each(this.gui.filters,function(a,b){if(parseInt(b.id)==parseInt(c))return d=!0,!1});
if(d)return!1}else if(a.is(".bracket")){var f=this.getGuiTokens(),g=this.$gui.children().index(b),j=null,k=0,l=0,m=")",h="(",n=")";")"==a.data("token")&&(f=f.reverse(),g=f.length-1-g,m="(",h=")",n="(");e.each(f,function(a,b){if(a==g)return l=k,!0;if(null!==l&&k==l&&a>g&&b==m)return j="("==m?f.length-1-a:a,!1;b==h?k++:b==n&&k--});null!==j&&(a=this.$gui.children().filter(".jcsdl-logic-token-wrap").eq(j),this.$gui.width(this.$gui.width()-a.outerWidth(!0)),a.remove())}this.$gui.width(this.$gui.width()-
b.outerWidth(!0));b.remove();this.updateFromGui();this.adjustGui()},_adjustGuiTimeout:null,adjustGui:function(){var a=this,b=0;this.$gui.children().each(function(){b+=parseInt(e(this).outerWidth(!0))});this.$gui.width(b);clearTimeout(this._adjustGuiTimeout);this._adjustGuiTimeout=setTimeout(function(){var b=a.$gui.width(),d=a.$guiContainer.width();b>d?a.$guiRight.removeClass("off"):(a.$guiLeft.add(a.$guiRight).addClass("off"),a.scrollGuiToStart())},50)},scrollGui:function(a,b){b=b==h?50:b;var c=-1*
Math.max(0,this.$gui.width()-this.$guiContainer.width()),d=0,f=this,d="number"===typeof a?a:parseInt(this.$gui.css("left"))+("right"==a?-30:30),d=Math.max(Math.min(0,d),c);this.$gui.stop(!0,!0).animate({left:d},b,function(){f.$guiLeft[0==d?"addClass":"removeClass"]("off");f.$guiRight[d==c?"addClass":"removeClass"]("off")})},scrollGuiToStart:function(){this.scrollGui(0)},scrollGuiToEnd:function(){this.scrollGuiToToken(this.$gui.children().last())},scrollGuiToToken:function(a){a=a.is(".jcsdl-logic-token")?
a.closest("li.jcsdl-logic-token-wrap"):a;if(!a.is("li.jcsdl-logic-token-wrap"))return!1;a=-1*a.position().left;parseInt(this.$gui.css("left"));this.scrollGui(a+140)},initManualInput:function(a){var b=this,c=null;a.keyup(function(){clearTimeout(c);c=setTimeout(function(){var c=a.val();b.logicString!==c&&(b.trigger("manualLogicChange",[c]),b.trigger("advancedLogicChange",[c]));try{b.validate(c)&&(b.clearErrors(),b.logicString=c)}catch(f){b.showError(f,!0)}},500)});a.keydown(function(a){var b=a.which,
c=a.shiftKey;8==b||(37<=b&&40>=b||46==b||48<=b&&57>=b&&!c||96<=b&&105>=b||219==b||57==b&&c||221==b||48==b&&c||32==b||55==b&&c||220==b&&c)||a.preventDefault()});a.keypress(function(a){13==a.which&&a.preventDefault()});return a},setManualString:function(a){a=a||this.logicString;a="string"===typeof a||"number"===typeof a?this.tokenize(a):a;this.$manualInput.val(a.join(" "))},getManualString:function(){return this.$manualInput.val()},setLogic:function(a,b){b=b||!1;var c=this.logic;this.logic=-1<e.inArray(a,
[this.AND,this.OR])?a:this.ADVANCED;var d="";if(this.logic==this.ADVANCED)d=a;else{var f=[];e.each(this.gui.filters,function(a,b){f.push(b.id)});d=f.join(this.logic==this.OR?"|":"&")}this.setLogicString(d);this.didSetLogic(c,b)},getLogic:function(){return this.logic},setLogicString:function(a){this.logicString=""+a;this.setGuiString(a);this.setManualString(a)},appendFilterToLogicString:function(a,b){b=b||this.logic;b=b==this.OR?"|":"&";var c=this.logicString.length?this.logicString+b+a:a;this.trigger("manualLogicChange",
[c]);this.trigger("graphicalLogicChange",[c]);this.trigger("advancedLogicChange",[c]);this.setLogicString(c)},getLogicString:function(){return this.logic==this.ADVANCED?this.logicString:this.logic},didSetLogic:function(a,b){a=a||"";b=b||!1;this.$logicOptions.removeClass("active").filter('[data-logic="'+this.logic+'"]').addClass("active");this.logic==this.ADVANCED?(this.showEditor(),this.$logicOptions.not(".jcsdl-advanced").each(function(){var a=e(this);a.html(a.data("textShort"))}),this.$advancedOptions.fadeIn(this.config.animate)):
(this.clearErrors(),this.hideEditor(),this.$logicOptions.not(".jcsdl-advanced").each(function(){var a=e(this);a.html(a.data("textLong"))}),this.$advancedOptions.hide());!b&&this.logic!==a&&this.trigger("logicChange",[this.logic])}}});;
;JCSDL.Loader.addComponent(function(e,f){this.GUI=function(a,b){var c=e(a);if(0==c.length)return!1;this.$el=c.eq(0);this.$container=null;this.config=e.extend(!0,{animate:200,cancelButton:!0,saveButton:null,googleMapsApiKey:"",mapsOverlay:{strokeWeight:0,fillColor:"#7585dd",fillOpacity:0.5},mapsMarker:"jcsdl/img/maps-marker.png",hideTargets:[],definition:{},change:function(){},save:function(){},saveError:function(){},cancel:function(){this.hide()},invalidJCSDL:function(){},viewModeChange:function(){},
filterNew:function(){},filterEdit:function(){},filterDelete:function(){},filterSave:function(){},filterCancel:function(){},targetSelect:function(){},operatorSelect:function(){},caseSensitivityChange:function(){},logicChange:function(){},logicError:function(){},advancedLogicChange:function(){},manualLogic:function(){},manualLogicChange:function(){},graphicalLogic:function(){},graphicalLogicChange:function(){},graphicalLogicTokenMove:function(){},parenthesisAdd:function(){},parenthesisDelete:function(){},
logicOperatorSwitch:function(){},targetHelpUrl:function(a,b){if(b.helpUrl)return b.helpUrl;a=a.replace(/\./g,"-");return this.definition.targetHelpJsonpSource.replace(/\{target\}/g,a)}},b);this.definition=e.extend(!0,JCSDLDefinition,this.config.definition);this.parser=new JCSDL.Parser(this);this.logic=null;this.inputs=new JCSDL.GUIInputs(this);this.filters=[];this.$filtersList=this.$mainView=this.currentFilterIndex=null;this.init()};this.GUI.prototype={changeEvents:["filterNew","filterDelete","filterSave",
"logicChange","advancedLogicChange"],init:function(){var a=this;this.filters=[];this.currentFilterIndex=null;this.$mainView=this.getTemplate("editor");this.$filtersList=this.$mainView.find(".jcsdl-filters-list");this.$container=this.getTemplate("container");this.$container.html(this.$mainView);this.$el.html(this.$container);this.$saveButton=this.$mainView.find(".jcsdl-editor-save");this.$cancelButton=this.$mainView.find(".jcsdl-editor-cancel");if(this.config.saveButton&&("object"==typeof this.config.saveButton||
"string"==typeof this.config.saveButton))this.$saveButton.remove(),this.$saveButton=e(this.config.saveButton);if(this.config.cancelButton&&("object"==typeof this.config.cancelButton||"string"==typeof this.config.cancelButton))this.$cancelButton.remove(),this.$cancelButton=e(this.config.cancelButton);this.config.cancelButton||this.$cancelButton.hide();e.browser.msie&&this.$container.addClass("msie");this.logic=new JCSDL.GUILogic(this,JCSDL.GUILogic.prototype.AND);this.$mainView.find(".jcsdl-mainview-mode .jcsdl-mainview-mode-option").bind("click touchstart",
function(b){b.preventDefault();b.target.blur();b=e(this);var c=b.attr("data-mode");a.$filtersList.removeClass("expanded collapsed");a.$filtersList.addClass(c);a.$mainView.find(".jcsdl-mainview-mode .jcsdl-mainview-mode-option").removeClass("active");b.addClass("active");a.trigger("viewModeChange",[c])});this.$mainView.find(".jcsdl-add-filter").bind("click touchstart",function(b){b.preventDefault();b.target.blur();a.showFilterEditor()});this.$saveButton.unbind(".jcsdl").bind("click.jcsdl touchstart.jcsdl",
function(b){b.preventDefault();b.target.blur();try{var c=a.returnJCSDL();a.trigger("save",[c])}catch(d){a.showError(d),a.trigger("saveError",[d instanceof JCSDL.LogicValidationException?d.message:d])}});this.$cancelButton.unbind(".jcsdl").bind("click.jcsdl touchstart.jcsdl",function(b){b.preventDefault();b.target.blur();a.trigger("cancel")})},reset:function(){this.init()},loadJCSDL:function(a){this.init();var b=this;try{var c=this.parser.parseJCSDL(a);this.filters=c.filters;2<=this.filters.length&&
this.logic.toggleButtons();this.logic.setLogic(c.logic,!0)}catch(d){return a=d instanceof JCSDL.ValidationException?d.code:a,this.showError(d,a),this.trigger("invalidJCSDL",[a]),!1}e.each(this.filters,function(a,c){b.createFilterRow(c).appendTo(b.$filtersList)});this.filters.length&&this.$mainView.find(".jcsdl-footer").show();this.config.cancelButton&&this.$cancelButton.show()},returnJCSDL:function(){return this.parser.getJCSDLForFilters(this.filters,this.logic.getLogicString())},adjust:function(){this.editor&&
this.editor.adjust()},hide:function(){this.$container.hide()},show:function(){this.$container.show()},trigger:function(a,b){b=b||[];this.$el.trigger(a.toLowerCase(),b);if("function"==typeof this.config[a])return this.config[a].apply(this,b);-1<e.inArray(a,this.changeEvents)&&this.trigger("change");return null},showFilterEditor:function(a,b){this.$mainView.hide();this.editor=new JCSDL.GUIFilterEditor(this,this.$container,a);if(a!==f&&a)this.currentFilterIndex=b,this.trigger("filterEdit",[a]);else{this.trigger("filterNew");
var c=this.filters[this.filters.length-1];c!==f&&this.editor.getView().find(".jcsdl-filter-target .target-"+c.target+":visible").trigger("jcsdlclick")}},hideFilterEditor:function(a){a="function"==typeof a?a:e.noop;var b=this;this.currentFilterIndex=null;this.editor.getView().fadeOut(this.config.animate,function(){e(this).remove();b.$mainView.show();b.editor=null;a.apply(b,[])})},didSubmitFilter:function(a){var b=this,c=e.noop,d=null!==this.currentFilterIndex?this.filters[this.currentFilterIndex].id:
this.createFilterId(),g=this.parser.createFilter(a.target,a.path,a.operator,a.value,a.additional,d);a=this.createFilterRow(g);null!==this.currentFilterIndex?(this.$filtersList.find(".jcsdl-filter.filter-"+g.id).replaceWith(a),this.filters[this.currentFilterIndex]=g):(a.appendTo(this.$filtersList),this.filters.push(g),c=function(){b.logic.appendFilterToLogicString(g.id)});this.filters.length&&this.$mainView.find(".jcsdl-footer").fadeIn(this.config.animate);2<=this.filters.length&&this.logic.toggleButtons();
this.hideFilterEditor(c);this.trigger("filterSave",[g])},deleteFilter:function(a){var b=this.filters[a];this.trigger("filterDelete",[b]);this.$filtersList.find(".jcsdl-filter.filter-"+b.id).remove();this.filters.splice(a,1);this.logic.deleteGuiFilterToken(b.id);this.filters.length||this.$mainView.find(".jcsdl-footer").fadeOut(this.config.animate);2>this.filters.length&&this.logic.toggleButtons(!1)},showError:function(a,b){if(a instanceof TypeError)throw a;this.clearErrors();if(a instanceof JCSDL.LogicValidationException)return this.logic.showError(a);
var c=a instanceof JCSDL.ValidationException?a.message:a,d=this.getTemplate("error");d.find("span").html(c);d.insertBefore(this.$mainView.find(".jcsdl-footer"));d.hide().fadeIn();console!==f&&console.error(c,arguments);d.animateIntoView(this.config.animate)},clearErrors:function(){this.$mainView.find(".jcsdl-error").remove()},createFilterRow:function(a){var b=this,c=this.getTemplate("filter");c.addClass("filter-"+a.id).data("filterId",a.id).find(".jcsdl-filter-info.id").html(a.id);var d=this.parser.getTargetInfo(a.target),
d=this.getTemplate("filterTarget").addClass("selected target-"+a.target).html(d.name);c.find(".target").html(d);var g=[];e.each(a.fieldPath,function(d,e){g.push(e);var f=b.parser.getFieldInfo(a.target,g),f=b.getTemplate("filterField").addClass("selected icon-"+b.getIconForField(e,f)).html(f.name);c.find(".jcsdl-filter-info.field").append(f)});var d=this.parser.getFieldInfo(a.target,g),f=this.getTemplate("filterOperator").addClass("operator-"+a.operator+" icon-"+a.operator+" selected").attr("title",
this.definition.operators[a.operator].description).html(this.definition.operators[a.operator].code.escapeHtml()).tipsy({gravity:"s",offset:9});c.find(".operator").html(f);if(a.cs){var h=this.getTemplate("filterOperator").addClass("operator-cs icon-cs selected").attr("title","Case Sensitive").html("case sensitive").tipsy({gravity:"s",offset:9});c.find(".jcsdl-filter-info.operator").append(h);h.tipsy("show")}if("exists"!==a.operator){var j=null,h=(j=0<=e.inArray(a.operator,["geo_box","geo_polygon",
"geo_radius"]))?a.operator:d.input;j&&(this.getTemplate("filterFieldInput").insertAfter(c.find(".jcsdl-filter-info.field")).find(".jcsdl-filter-field-input").addClass("selected icon-"+a.operator),f.remove());j=this.inputs[h]&&"function"==typeof this.inputs[h].displayValue?this.inputs.exec(h,"displayValue",[d,a.value,a]):this.getTemplate("filterValue").html(a.value.truncate(50).escapeHtml());c.find(".value").addClass("input-"+h).html(j);c.find(".operator").addClass("input-"+h)}else c.find(".value").remove();
c.data("filter",a);c.find(".edit").bind("click touchstart",function(d){d.preventDefault();d.target.blur();b.showFilterEditor(a,b.getFilterIndexByElement(c))});c.find(".delete").bind("click touchstart",function(a){a.preventDefault();a.target.blur();b.deleteFilter(b.getFilterIndexByElement(c))});return c},createFilterId:function(){var a=[],b=1;for(e.each(this.filters,function(b,d){a.push(parseInt(d.id))});0<=e.inArray(b,a);)b++;return b},highlightFilter:function(a,b){b=b===f?!0:!1;this.$filtersList.find(".filter-"+
a)[b?"addClass":"removeClass"]("on")},getTemplate:function(a){return JCSDL.GUITemplates[a]!==f?JCSDL.GUITemplates[a].clone():e()},getIconForField:function(a,b){return b.icon!==f?b.icon:a},getFilterIndexByElement:function(a){return this.$filtersList.find(".jcsdl-filter").index(a)}};e.fn.jcsdlGui=function(a){function b(b){var c=b.data("jcsdlGui");c||(c=new JCSDL.GUI(b,a),b.data("jcsdlGui",c));return c}if("string"==typeof a){if(0<=e.inArray(a,["loadJCSDL","adjust"])){var c=[];e.each(arguments,function(a,
b){if(0==a)return!0;c.push(b)});this.each(function(){var d=b(e(this));d[a].apply(d,c)})}return this}this.each(function(){b(e(this))});return this};JCSDLGui=function(a,b){return new JCSDL.GUI(a,b)}});;
;(function(){if(window.jQuery)JCSDL.Loader.load();else{var b=document.getElementsByTagName("head"),a=document.createElement("script");a.src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js";a.type="text/javascript";b[0].appendChild(a);JCSDL.Loader.timeout(!0)}})();;
